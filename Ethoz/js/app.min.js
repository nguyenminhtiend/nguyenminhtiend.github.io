!function(){"use strict";function e(e,t){t.hashPrefix(""),e.when("/",{redirectTo:"/home"}).otherwise({redirectTo:"/"})}function t(e,t,n){e.$on("$locationChangeStart",function(e,t,n){}),e.$on("$routeChangeSuccess",function(){t.current.title?document.title="Ethoz - "+t.current.title:document.title="Ethoz"})}angular.module("main.module",["ngRoute","ui.bootstrap","ngMap","ngDraggable","LocalStorageModule","ui.bootstrap.contextMenu","dashboard.module","vehicleManagement.module","jobDetail.module"]).config(e).run(t),e.$inject=["$routeProvider","$locationProvider"],t.$inject=["$rootScope","$route","$location"]}(),function(){"use strict";angular.module("main.module").constant("systemSetting",{serviceUrl:window.env.apiUrl}).constant("calendarSetting",{startTime:12,sizeHour:6,percentagePerJob:12.5}).constant("jobStatus",{unassigned:{value:0,text:"Unassigned"},assigned:{value:1,text:"Assigned"},inProgress:{value:2,text:"In Progress"},completed:{value:3,text:"Completed"},cancelled:{value:4,text:"Cancelled"}}).constant("taskStatus",{unassigned:{value:0,text:"Unassigned"},assigned:{value:1,text:"Assigned"},completed:{value:2,text:"Completed"},cancelled:{value:3,text:"Cancelled"}}).constant("driverStatus",{available:"available",onLeave:"onLeave",onLeaveButHaveJob:"onLeaveButHaveJob"}).constant("driverUnAvailable",{AM:{startTime:"8:30",endTime:"13:30",text:"On Leave - Half Day"},PM:{startTime:"12:30",endTime:"18",text:"On Leave - Half Day"},Both:{startTime:"8:30",endTime:"18",text:"On Leave - Whole Day"}})}(),function(){"use strict";function e(e){e.when("/dashboard",{title:"Dashboard",controller:"DashboardController",templateUrl:"app/views/dashboard/dashboard.html",controllerAs:"vm",className:"Dashboard"}).when("/home",{title:"Home",controller:"DashboardController",templateUrl:"app/views/dashboard/home.html",controllerAs:"vm",className:"home"})}function t(e,t,n,a){function i(){l.timeSetting={startTime:e.startTime,sizeHour:e.sizeHour},l.calendarViewMode=!0,l.currentDate=new Date,l.criteria={driver:"",branchLocation:""}}function r(){l.isLoading=!0,t.getDriverTimeLineByCriteria(l.currentDate,l.criteria).then(function(e){l.isLoading=!1,l.drivers=t.convertListDriverTimeLine(e.data),c()})}function o(){c()}function s(){r(),l.reloadRequestAndTask()}function u(e,t,n){n||l.reloadRequestAndTask(),angular.forEach(l.drivers,function(t){if(t.requests&&t.requests.length)for(var n=0;n<t.requests.length;n++)t.requests[n].id===e.id&&t.requests.splice(n,1)}),angular.forEach(l.drivers,function(n){n.id===t&&(n.requests=n.requests||[],n.requests.push(e))}),c()}function c(){l.currentTimeStyleDisplay=t.initStyleForCurrentTime(l.timeSetting.startTime,l.timeSetting.sizeHour,l.currentDate),angular.forEach(l.drivers,function(e){e.currentTimeStyles=l.currentTimeStyleDisplay,t.populateStyleForDriver(e,l.timeSetting.startTime,l.timeSetting.sizeHour),angular.forEach(e.requests,function(a){t.getRequestStatusFromJob(a),t.populateStyleForRequest(e,a,l.timeSetting.startTime,l.timeSetting.sizeHour),n.checkIsToDay(l.currentDate)&&t.checkJobInCurrentTime(a,l.timeSetting.startTime,l.timeSetting.sizeHour)})})}var l=this;l.reAssignDriver=u,l.reRenderCalendar=o,l.getDriverByCriteria=r,l.currentDateChange=s,function(){i(),r(),l.reloadRequestAndTask={}}()}angular.module("dashboard.module",["ngRoute"]).config(e).controller("DashboardController",t),e.$inject=["$routeProvider"],t.$inject=["calendarSetting","dashboardService","timeService","jobStatus"]}(),function(){"use strict";function e(e){e.when("/itemChecklist",{title:"itemChecklist",controller:"vehicleManagementController",templateUrl:"app/views/vehicleManagement/vehicleItemChecklist.html",controllerAs:"vm"}).when("/eventLog",{title:"eventLog",controller:"vehicleManagementController",templateUrl:"app/views/vehicleManagement/eventLog.html",controllerAs:"vm"}).when("/vehicleType",{title:"vehicleType",controller:"vehicleManagementController",templateUrl:"app/views/vehicleManagement/vehicleType.html",controllerAs:"vm"}).when("/vehicleList",{title:"vehicleList",controller:"vehicleManagementController",templateUrl:"app/views/vehicleManagement/vehicleList.html",controllerAs:"vm"})}function t(e,t,n){this.requestNo="38183"}angular.module("vehicleManagement.module",["ngRoute"]).config(e).controller("vehicleManagementController",t),e.$inject=["$routeProvider"],t.$inject=["events","$rootScope","timeService"]}(),function(){"use strict";function e(e){e.when("/jobDetail",{title:"jobDetail",controller:"jobDetailController",templateUrl:"app/views/jobDetail/jobDetail.html",controllerAs:"vm"})}function t(e,t,n){var a=this;a.vehicleModelName="Corrolla Altis",a.vehicleNumber="DFZ 2929 X",a.status={completed:"Completed",ongoing:"Ongoing"},a.job={status:a.status.completed}}angular.module("jobDetail.module",["ngRoute"]).config(e).controller("jobDetailController",t),e.$inject=["$routeProvider"],t.$inject=["events","$rootScope","timeService"]}(),function(){"use strict";function e(e,t){var n=this;n.data=t,n.ok=function(t){e.close(t)},n.cancel=function(){e.dismiss("cancel")}}angular.module("main.module").controller("ModalInstanceController",e),e.$inject=["$uibModalInstance","data"]}(),function(){"use strict";function e(e,t,n){e.$on("$routeChangeSuccess",function(){"Home"===t.current.title?n.home=!0:n.home=!1})}angular.module("main.module").component("headerPage",{bindings:{},templateUrl:"app/components/headerPage/headerPage.html",controller:e,controllerAs:"vm"}),e.$inject=["$rootScope","$route","$scope","$location"]}(),function(){"use strict";function e(e,t,n){e.$on("$routeChangeSuccess",function(){"Home"===t.current.title?n.footer=!0:n.footer=!1})}angular.module("main.module").component("footerPage",{bindings:{},templateUrl:"app/components/footerPage/footerPage.html",controller:e,controllerAs:"vm"}),e.$inject=["$rootScope","$route","$scope"]}(),function(){"use strict";function e(e){function t(){i.ranges=[],i.textHours=[];for(var t=0;t<i.timeSetting.sizeHour;t++)i.ranges.push(t+i.timeSetting.startTime),i.textHours.push(e.timeToStringMaker(t+i.timeSetting.startTime));i.textHours.push(e.timeToStringMaker(i.timeSetting.startTime+i.timeSetting.sizeHour)),i.timeText=e.getCurrentTimeText()}function n(){i.timeSetting.startTime+=1,t(),i.timeChange()}function a(){i.timeSetting.startTime-=1,t(),i.timeChange()}var i=this;i.next=n,i.back=a,i.$onInit=function(){t()}}angular.module("main.module").component("timeControl",{bindings:{timeSetting:"=",timeChange:"&",currentDate:"<",currentTimeStyleDisplay:"<"},templateUrl:"app/components/dashboard/timeControl/timeControl.html",controller:e,controllerAs:"vm"}),e.$inject=["timeService"]}(),function(){"use strict";function e(e,t,n){function a(){s()}function i(e,n,a,i){if(e){var o=angular.copy(e),s=!!o.startTime;t.populateTimeForRequestAfterDrop(o,angular.copy(a)),r(o,i,s)}}function r(e,n,a){u.isLoading=!0;var i=t.getAssignRequestData(e,n);t.assignRequest(i).then(function(t){u.isLoading=!1,u.reAssignDriver({request:e,driverId:n,isAssigned:a})})}function o(e,n,a){t.setDuration(e,n,a),u.reRenderCalendar()}function s(){u.draps=[];for(var e=u.timeSetting.startTime,t=0,n=2,a=e;a<u.timeSetting.startTime+u.timeSetting.sizeHour;a++)u.draps.push({style:{left:12.5*n/2+"%"},hour:a,minute:t}),n++,0!=t?30==t&&(t=0):(a--,t=30)}var u=this;u.jobStatus=e,u.driverStatus=n,u.$onInit=a,u.onDropComplete=i,u.setDuration=o}angular.module("main.module").component("driverChartTime",{bindings:{driver:"=",isLoading:"=",timeSetting:"<",isTaskActive:"<",reAssignDriver:"&",currentDate:"=",reRenderCalendar:"&"},templateUrl:"app/components/dashboard/driverChartTime/driverChartTime.html",controller:e,controllerAs:"vm"}),e.$inject=["jobStatus","dashboardService","driverStatus"]}(),function(){"use strict";function e(e,t){function n(e,t){a.currentJob=t,a.map.showInfoWindow("job-info",t.id)}var a=this;a.showDetail=n,a.$onInit=function(){e.getMap().then(function(e){a.map=e}),a.status={completed:"completed",pending:"pending",notstart:"notstart"},t(function(){a.jobs=[{id:"123",plateNo:"",address:"20 Ubi Avenue 4, Singapore",title:"Test Driver",status:a.status.notstart,driver:"Latif",label:{text:"Latif",color:"white",fontSize:"12px"}},{id:"633",plateNo:"SGR 1451 SDG 6496",address:"Ethoz Group Ltd., Tampines Street 92, Singapore",title:"Replacement",status:a.status.pending,label:{text:"Lisheng",color:"white",fontSize:"12px"}}]},2e3)},a.placeChanged=function(){a.place=this.getPlace(),a.map.setCenter(a.place.geometry.location)},a.click=function(){alert("6236236")},a.icon={url:"./img/driver.png"}}angular.module("main.module").component("jobOnMap",{bindings:{},templateUrl:"app/components/dashboard/jobOnMap/jobOnMap.html",controller:e,controllerAs:"vm"}),e.$inject=["NgMap","$timeout"]}(),function(){"use strict";function e(e,t){function n(){a()}function a(){var n=t.checkIsToDay(s.currentDate)?"Today":e("date")(s.currentDate,"EEE");s.dateFormat=n+", "+o(s.currentDate.getDate())+" "+e("date")(s.currentDate,"MMM")+", "+s.currentDate.getFullYear()}function i(){s.currentDate.setDate(s.currentDate.getDate()+1),a(),s.dateChange()}function r(){s.currentDate.setDate(s.currentDate.getDate()-1),a(),s.dateChange()}function o(e){return e%20==1||e%30==1?e+"st":e%20==2||e%30==2?e+"nd":e%20==3||e%30==3?e+"rd":e+"th"}var s=this;s.$onInit=n,s.next=i,s.previous=r}angular.module("main.module").component("dateControl",{bindings:{currentDate:"=",dateChange:"&"},templateUrl:"app/components/dashboard/dateControl/dateControl.html",controller:e,controllerAs:"vm"}),e.$inject=["$filter","timeService"]}(),function(){"use strict";function e(e,t){function n(){a(),i()}function a(){e.getAllBranchLocation().then(function(e){s.branchLocations=e.data,s.branchLocations.unshift({id:"",name:"All Locations"})})}function i(){e.getDriverByBranchLocation(s.branchLocation).then(function(e){s.drivers=e.data,s.drivers.unshift({id:"",firstname:"All",lastname:"Drivers"})})}function r(){s.driver="",t(function(){i(),s.reloadTimeLine()})}function o(){t(function(){s.reloadTimeLine()})}var s=this;s.$onInit=n,s.onLocationChange=r,s.onDriverChange=o}angular.module("main.module").component("filterDashboard",{bindings:{calendarViewMode:"=",branchLocation:"=",driver:"=",reloadTimeLine:"&"},templateUrl:"app/components/dashboard/filterDashboard/filterDashboard.html",controller:e,controllerAs:"vm"}),e.$inject=["dashboardService","$timeout"]}(),function(){"use strict";function e(e,t,n){function a(){s.reLoad=i,s.criteria={status:"",search:""},r(),i()}function i(){s.isLoading=!0,t.getRequestByCriteria(s.currentDate,s.criteria).then(function(e){s.isLoading=!1,s.requests=t.convertListRequestSearch(e.data)})}function r(){s.listJobStatus=n.getListFromObject(e),s.listJobStatus.unshift({value:"",text:"All Requests"})}function o(e){angular.element(document.getElementsByClassName("selected-item")).removeClass("selected-item"),angular.element(document.querySelector("#request-tab-"+e)).addClass("selected-item"),angular.element(document.querySelector("#request-"+e)).addClass("selected-item")}var s=this;s.jobStatus=e,s.$onInit=a,s.selectJob=o,s.getRequestByCriteria=i}angular.module("main.module").component("requestTab",{bindings:{currentDate:"<",reLoad:"="},templateUrl:"app/components/dashboard/requestTab/requestTab.html",controller:e,controllerAs:"vm"}),e.$inject=["jobStatus","dashboardService","utilityService"]}(),function(){"use strict";function e(e,t,n,a,i){function r(){m.job.starTimeString=a.timeToStringFormatMaker(m.job.startTime),m.job.endTimeString=a.timeToStringFormatMaker(m.job.endTime),m.menuOptions=[["Set duration",s],null,["Add task",u],null,["Add petrol card",function(e,t,n,a,i){alert("Add petrol card")}],null,["Upload document",c]]}function o(e,t){var a=e;a.status=i.assigned.value,a.jobId=m.job.id,a.driver=m.driverName,m.isLoading=!0,n.assignTask({taskId:a.id,jobId:m.job.id}).then(function(e){m.isLoading=!1,m.job.tasks=m.job.tasks||[],m.job.tasks.push(angular.copy(a))})}function s(){m.durationData={hour:"1"};var t={setDurationSuccess:l};e.createPopup({templateUrl:"app/components/dashboard/jobCell/setDurationModal.html",size:"md",data:m.durationData},t)}function u(){m.addTaskData={jobId:m.job.id,date:new Date,type:"Errand",status:i.assigned.value};var t={onAddTask:d};e.createPopup({templateUrl:"app/components/dashboard/jobCell/addTaskModal.html",size:"md",data:m.addTaskData},t)}function c(){var t={uploadDocument:{}};e.createPopup({templateUrl:"app/components/dashboard/jobCell/uploadDocumentModal.html",size:"md",data:{jobId:m.job.id,pickupAddress:m.job.pickupAddress,deliveryAddress:m.job.deliveryAddress}},t)}function l(){m.isLoading=!0;var e=n.getDurationData(m.request,m.job,parseFloat(m.durationData.hour));n.saveTimeDuration(e).then(function(e){m.isLoading=!1,m.setDuration({request:m.request,job:m.job,hour:parseFloat(m.durationData.hour)})})}function d(){m.isLoading=!0,n.createTask(m.addTaskData).then(function(e){m.isLoading=!1,m.job.tasks=m.job.tasks||[],m.job.tasks.push(angular.copy(m.addTaskData))})}var m=this;m.jobStatus=t,m.taskStatus=i,m.onDropComplete=o,m.$onInit=r}angular.module("main.module").component("jobCell",{bindings:{job:"=",isLoading:"=",request:"<",isTaskActive:"<",setDuration:"&",driverName:"@"},templateUrl:"app/components/dashboard/jobCell/jobCell.html",controller:e,controllerAs:"vm"}),e.$inject=["modalService","jobStatus","dashboardService","timeService","taskStatus"]}(),function(){"use strict";function e(e,t,n,a){function i(){h.reLoad=r,h.criteria={status:"",search:""},o(),r()}function r(){h.isLoading=!0,a.getTaskByCriteria(h.currentDate,h.criteria).then(function(e){h.isLoading=!1,h.tasks=e.data})}function o(){h.listTaskStatus=n.getListFromObject(e),h.listTaskStatus.unshift({value:"",text:"All Tasks"})}function s(t){h.criteria.status===e.unassigned.value&&h.tasks.splice(t,1)}function u(e){13===e.which&&(getRequestByCriteria(),e.preventDefault())}function c(e,n){h.taskDetail=angular.copy(e),h.currentIndex=n;var a={onUpdateTask:d,unAssignDriver:m};t.createPopup({templateUrl:"app/components/dashboard/taskTab/editTaskModal.html",size:"md",data:h.taskDetail},a)}function l(){h.addTaskData={status:e.unassigned.value,date:new Date,type:"Errand"};var n={onAddTask:p};t.createPopup({templateUrl:"app/components/dashboard/jobCell/addTaskModal.html",size:"md",data:h.addTaskData},n)}function d(){h.isLoading=!0,a.updateTask(h.taskDetail).then(function(e){h.isLoading=!1,h.tasks[h.currentIndex]=h.taskDetail})}function m(){h.isLoading=!0,a.unAssignTask({taskId:h.taskDetail.id}).then(function(e){r()})}function p(){h.isLoading=!0,a.createTask(h.addTaskData).then(function(e){h.isLoading=!1,h.tasks.push(angular.copy(h.addTaskData))})}var h=this;h.$onInit=i,h.taskStatus=e,h.addTask=l,h.editTask=c,h.pressSearch=u,h.onDragComplete=s,h.getTaskByCriteria=r}angular.module("main.module").component("taskTab",{bindings:{currentDate:"<",reLoad:"="},templateUrl:"app/components/dashboard/taskTab/taskTab.html",controller:e,controllerAs:"vm"}),e.$inject=["taskStatus","modalService","utilityService","dashboardService"]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.status={available:"available",empty:"empty"},e.exteriorListItems=[{description:"Radio Antenna",status:e.status.available,change:"yes"},{description:"Number Plate",status:e.status.empty,change:"no"},{description:"Petrol Cap",status:e.status.available,change:"no"},{description:"4 Hub Caps/Rims",status:e.status.available,change:"yes"},{description:"Road Tax Expiry",status:e.status.available,change:"yes"},{description:"Speedlimit Label",status:e.status.available,change:"yes"},{description:"Panel Markings",status:e.status.available,change:"yes"}],e.interiorListItems=[{description:"Cash Card",status:e.status.available,change:"yes"},{description:"Manual Book",status:e.status.empty,change:"no"},{description:"Radio/Cassette",status:e.status.available,change:"no"},{description:"CD Player/Cartridge",status:e.status.available,change:"yes"},{description:"Ashtray",status:e.status.available,change:"yes"},{description:"4 Hub Caps/Rims",status:e.status.available,change:"yes"}],e.othersListItems=[{description:"Rear Booth Carpet/Mat",status:e.status.available,change:"no"},{description:"Supporting Board",status:e.status.empty,change:"no"},{description:"Spare Tyre",status:e.status.available,change:"no"},{description:"Wheel Brace",status:e.status.available,change:"no"},{description:"Tools Kit",status:e.status.available,change:"yes"},{description:"Breakdown Sign",status:e.status.empty,change:"no"},{description:"First Aid Kit",status:e.status.empty,change:"no"},{description:"Jack/Lever",status:e.status.available,change:"no"}],e.customListItems=[{description:"Custom 1",status:e.status.available,change:"yes"},{description:"Custom 2",status:e.status.empty,change:"no"},{description:"Custom 3",status:e.status.available,change:"no"},{description:"Custom 4",status:e.status.available,change:"no"}]}}angular.module("main.module").component("checklistBox",{bindings:{},templateUrl:"app/components/checklist/checklistBox/checklistBox.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.eventListItems=[{description:"Vehicle handed over from Yardsman to Driver",date:"07/06/2016",time:"10:45pm"},{description:"Item Checklist completed",date:"07/06/2016",time:"10:45pm"},{description:"Logged 1 issue",date:"07/06/2016",time:"10:45pm"},{description:"Vehicle handed over from Driver to Client",date:"07/06/2016",time:"10:45pm"},{description:"Vehicle handed over from Yardsman to driver",date:"07/06/2016",time:"10:45pm"},{description:"Logged 1 issue",date:"07/06/2016",time:"10:45pm"},{description:"Vehicle handed over from Driver to Client",date:"07/06/2016",time:"10:45pm"}]}}angular.module("main.module").component("eventBox",{bindings:{},templateUrl:"app/components/checklist/eventBox/eventBox.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.status={available:"available",empty:"empty"},e.vehicleTypes=[{name:"Sedan",id:1,checklist:e.status.available},{name:"SUV",id:2,checklist:e.status.empty},{name:"Pickup",id:3,checklist:e.status.empty},{name:"Minivan",id:4,checklist:e.status.available},{name:"Coupe",id:5,checklist:e.status.available},{name:"Van",id:6,checklist:e.status.available},{name:"Wagon",id:7,checklist:e.status.available},{name:"Hatchback",id:8,checklist:e.status.available}]}}angular.module("main.module").component("vehicleType",{bindings:{},templateUrl:"app/components/checklist/vehicleType/vehicleType.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(e){function t(){r.addNewSubSectionDate={id:(new Date).getTime(),name:"",checkListItems:[]};var t={onAddSubSection:n};e.createPopup({templateUrl:"app/components/checklist/vehicleList/addNewSubSectionModal.html",size:"md",data:r.addNewSubSectionDate},t)}function n(){r.checkListCategories.push(r.addNewSubSectionDate)}function a(t){r.addNewItemData={newItem:{id:(new Date).getTime(),description:""},subSectionName:r.checkListCategories[t].name,index:t};var n={onAddNewItem:i};e.createPopup({templateUrl:"app/components/checklist/vehicleList/addNewItemModal.html",size:"md",data:r.addNewItemData},n)}function i(){r.checkListCategories[r.addNewItemData.index].checkListItems.push(r.addNewItemData.newItem)}var r=this;r.addNewSubSection=t,r.addNewItem=a,r.$onInit=function(){r.checkListCategories=[{id:"1",name:"Exterior",checkListItems:[{id:"1",description:"Radio Antenna"},{id:"2",description:"Number Plate"}]}]}}angular.module("main.module").component("vehicleList",{bindings:{},templateUrl:"app/components/checklist/vehicleList/vehicleList.html",controller:e,controllerAs:"vm"}),e.$inject=["modalService"]}(),function(){"use strict";function e(e,t){function n(){r.uploadStatus={isNotUpload:"isNotUpload",uploading:"uploading",uploaded:"uploaded"},r.status=r.uploadStatus.isNotUpload}function a(){e(function(){document.getElementById("documentUpload").click()})}function i(){for(var e=new FormData,n=0;n<r.documentFiles.length;n++)e.append("file",r.documentFiles[n]);e.append("jobId",r.data.jobId),r.numberOfDocument=r.documentFiles.length,t.uploadDocument(e).then(function(e){r.status=r.uploadStatus.uploaded,angular.element(document.getElementById("documentUpload")).val(null)})}var r=this;r.$onInit=n,r.uploadFiles=i,r.actionClick=a}angular.module("main.module").component("uploadDocument",{bindings:{data:"=",onCancel:"&"},templateUrl:"app/components/dashboard/uploadDocument/uploadDocument.html",controller:e,controllerAs:"vm"}),e.$inject=["$timeout","dashboardService"]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.dataCollect={startTime:"07/07/2016 10:34AM",startLocation:"Ethoz Tampines",handoverComplete:"N/A",handoverLocation:"2 Kaki Bukit Ave 1 #01-04 Singapore 292913",handoverIC:"Albert Low",distTravel:"N/A",timeTaken:"N/A"}}}angular.module("main.module").component("collectData",{bindings:{},templateUrl:"app/components/job/dataCollect/dataCollect.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.eventListItems=[{description:"Vehicle handed over from Yardsman to Driver",date:"07/06/2016",time:"10:45pm"},{description:"Item Checklist completed",date:"07/06/2016",time:"10:45pm"},{description:"Logged 1 issue",date:"07/06/2016",time:"10:45pm"},{description:"Vehicle handed over from Driver to Client",date:"07/06/2016",time:"10:45pm"},{description:"Vehicle handed over from Yardsman to driver",date:"07/06/2016",time:"10:45pm"},{description:"Logged 1 issue",date:"07/06/2016",time:"10:45pm"},{description:"Vehicle handed over from Driver to Client",date:"07/06/2016",time:"10:45pm"}],e.quantity=4}}angular.module("main.module").component("eventLog",{bindings:{},templateUrl:"app/components/job/eventLog/eventLog.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.checklist=[{type:"Item Checklist",description:"5 changes reported"},{type:"Exterior Checklist",description:"2 Issues reported"},{type:"Exterior Checklist",description:"2 Issues reported"}],e.quantity=2}}angular.module("main.module").component("handoverDriver",{bindings:{},templateUrl:"app/components/job/handoverDriver/handoverDriver.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.checklist=[{type:"Item Checklist",description:"3 changes reported"},{type:"Exterior Checklist",description:"1 Issues reported"},{type:"Exterior Checklist",description:"2 Issues reported"}],e.quantity=2}}angular.module("main.module").component("handoverCustomer",{bindings:{},templateUrl:"app/components/job/handoverCustomer/handoverCustomer.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.replacement={detail:"Item Checklist",requestBy:"5 changes reported",requestNo:"38328308",customerName:"Darren Yip",customerNo:"38381118",driverName:"Boon Hock",driverNo:"88382110",location:"2 Kaki Bukit Avenue 1 #01-04",remark:"Nil"}}}angular.module("main.module").component("replacement",{bindings:{},templateUrl:"app/components/job/replacement/replacement.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.status={completed:"Completed",ongoing:"Ongoing"},e.taskAssign=[{status:e.status.ongoing,description:"Document Signing",timeTaken:"4:10PM - 5.11PM (1hr 1 min)"},{status:e.status.completed,description:"Pick up Latif from XYS around 4:20PM",timeTaken:"5:20PM - 6.20PM (1hr 0 min)"},{status:e.status.completed,description:"Pick up Latif from XYS around 4:20PM",timeTaken:"5:20PM - 6.20PM (1hr 0 min)"}]}}angular.module("main.module").component("taskAssign",{bindings:{},templateUrl:"app/components/job/taskAssign/taskAssign.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.status={signed:"Signed",unsigned:"Not Signed"},e.uploadDoc=[{status:e.status.signed,docName:"termsandcondition.pdf"},{status:e.status.unsigned,docName:"document.pdf"}]}}angular.module("main.module").component("uploadDoc",{bindings:{},templateUrl:"app/components/job/uploadDoc/uploadDoc.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.$onInit=function(){e.petrolLog={logged:"07/07/2016 10:34AM",mileage:"12000km",gasoline:"7/8"}}}angular.module("main.module").component("petrolLog",{bindings:{},templateUrl:"app/components/job/petrolLog/petrolLog.html",controller:e,controllerAs:"vm"}),e.$inject=[]}(),function(){"use strict";function e(e){return{restrict:"A",link:function(t,n,a){var i=e(a.fileModel),r=i.assign,o=t.$eval(a.customOnChange);n.bind("change",function(){r(t,n[0].files),o()})}}}angular.module("main.module").directive("fileModel",e),e.$inject=["$parse"]}(),function(){"use strict";function e(e,t,n){function a(e){e.headers=e.headers||{};var n=t.get("tokenInfo");return n&&(e.headers.Authorization=n.token_type+" "+n.access_token),e}function i(a){return 401===a.status&&(t.remove("tokenInfo"),t.remove("userInfo"),n.path("/accessDeny")),e.reject(a)}return{request:a,responseError:i}}angular.module("main.module").factory("httpInterceptor",e),e.$inject=["$q","localStorageService","$location"]}(),function(){"use strict";function e(e){function t(t){return e("orderBy")(t,function(e){return e.startTime},!1,a)}function n(e){var t=e.split(":"),n={hour:parseInt(t[0])};return n.minute=t.length>1?parseInt(t[1]):0,n}function a(e,t){if(!Number.isInteger(e.value)&&!Number.isInteger(t.value)){var a=n(e.value),i=n(t.value);return a.hour>i.hour||a.hour==i.hour&&a.minute>i.minute}}function i(e){var t=[];for(var n in e)t.push({value:e[n].value,text:e[n].text});return t}return{sortByStartTime:t,getTimeObject:n,getListFromObject:i}}angular.module("main.module").factory("utilityService",e),e.$inject=["$filter"]}(),function(){"use strict";function e(e){function t(t,n,a){e.open({animation:!0,templateUrl:t.templateUrl,controller:"ModalInstanceController",controllerAs:"vm",size:t.size,backdrop:"static",resolve:{data:function(){return t.data},readOnly:function(){return t.readOnly}}}).result.then(function(e){n[e]()},a)}return{createPopup:t}}angular.module("main.module").factory("modalService",e),e.$inject=["$uibModal"]}(),function(){"use strict";function e(e){function t(e,t){var n=new Date,a=n.getHours(),i=n.getMinutes();return!(a<e||a>e+t||a===e+t&&i>0)}function n(e){var t=new Date;return e.setHours(0,0,0,0)==t.setHours(0,0,0,0)}function a(e,t,n,a){return v*o(e,t,n,a)/60}function i(e,t,n,a,i,s){var u=r(e,t,i,s);return o(n,a,i,s)*u}function r(e,t,n,a){return 100/o(e,t,n,a)}function o(e,t,n,a){var i=c(e.toString());return s(c(t),n,a)-s(i,n,a)}function s(e,t,n){var a=e.hour,i=e.minute;return a<t&&(a=t,i=0),(a>t+n||a===t+n&&i>0)&&(a=t+n,i=0),60*a+i}function u(t){return e("orderBy")(t,function(e){return e.startTime},!1,m)}function c(e){var t=e.split(":"),n={hour:parseInt(t[0])};return n.minute=t.length>1?parseInt(t[1]):0,n}function l(){var e=new Date;return e.getHours()+":"+e.getMinutes()}function d(){return e("date")(new Date,"h:mm a")}function m(e,t){if(!Number.isInteger(e.value)&&!Number.isInteger(t.value)){var n=c(e.value),a=c(t.value);return n.hour>a.hour||n.hour==a.hour&&n.minute>a.minute}}function p(e,t){var n=c(e),a=c(t);return n.hour>a.hour||n.hour==a.hour&&n.minute>a.minute}function h(e){return 0===e||24===e?"12 AM":12===e?e+" PM":e>12?e-12+" PM":e+" AM"}function g(t){var n=c(t),a=new Date;return a.setHours(n.hour,n.minute),e("date")(a,"h:mm a")}var v=12.5;return{sortByStartTime:u,getTimeObject:c,getCurrentTime:l,getPercentageFromDistance:a,getPercentageFromDistanceInRequest:i,isShowCurrentTime:t,getCurrentTimeText:d,checkIsToDay:n,compareTimeObject:p,timeToStringMaker:h,timeToStringFormatMaker:g,getTotalMinute:s}}angular.module("main.module").factory("timeService",e),e.$inject=["$filter"]}(),function(){"use strict";function e(e,t,n,a,i,r,o,s){function u(n,a){var i={date:t("date")(n,"yyyy-MM-dd")};return a.branchLocation&&(i.branchLocationId=a.branchLocation),a.driver&&(i.driverId=a.driver),e.get(z+"/requests/driver",{params:i})}function c(n,a){var i={date:t("date")(n,"yyyy-MM-dd")};return a.search&&(i.search=a.search),(a.status||0==a.status)&&(i.status=a.status),e.get(z+"/requests",{params:i})}function l(n,a){var i={date:t("date")(n,"yyyy-MM-dd")};return a.search&&(i.search=a.search),(a.status||0===a.status)&&(i.status=a.status),e.get(z+"/tasks",{params:i})}function d(t){return e.post(z+"/requests/assign",t)}function m(t){return e.post(z+"/tasks",t)}function p(t){return e.put(z+"/tasks/"+t.id,t)}function h(t){return e.post(z+"/tasks/assign",t)}function g(t){return e.post(z+"/tasks/unassign",t)}function v(t){return e.post(z+"/jobs/setduration",t)}function f(t){return e.post(z+"/jobs/upload-document-signing",t,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}function b(){return e.get(z+"/branchlocations")}function T(t){var n=z+"/branchlocations/drivers";return n=t?n+"/?branchLocationId="+t:n,e.get(n)}function D(e,t,i){var r=n.getPercentageFromDistance(e.startTime,e.endTime,t,i);e.style={width:r+"%",left:n.getPercentageFromDistance(t,e.startTime,t,i)+a.percentagePerJob+"%"},e.isDisplay=0!==r}function y(e,t,n){if(!e.amAvailability&&!e.pmAvailability)return void(e.status=s.available);var a;e.amAvailability&&(a=o.AM),e.pmAvailability&&(a=o.PM),e.amAvailability&&e.pmAvailability&&(a=o.Both),(e.amAvailability||e.pmAvailability)&&(S(e)?e.status=s.onLeaveButHaveJob:e.status=s.onLeave);var i=k(a,t,n);e.style=i.style,e.isDisplay=i.isDisplay,e.leaveText=a.text,e.timeObject=a}function S(e){return e&&e.requests&&e.requests.length>0&&e.requests[0].jobs&&e.requests[0].jobs.length>0}function k(e,t,i){var r=n.getPercentageFromDistance(e.startTime,e.endTime,t,i);return{style:{width:r+"%",left:n.getPercentageFromDistance(t,e.startTime,t,i)+a.percentagePerJob+"%"},isDisplay:0!==r}}function j(e,t,n,a){if(D(t,n,a),t.isDisplay){var i=!0;angular.forEach(t.jobs,function(r){C(e,t,r,n,a,i),i=!1})}}function C(e,t,a,i,r,o){var s=n.getPercentageFromDistanceInRequest(t.startTime,t.endTime,a.startTime,a.endTime,i,r),u=n.getPercentageFromDistanceInRequest(t.startTime,t.endTime,t.startTime,a.startTime,i,r);o&&(a.type=t.type),a.style={width:s+"%",left:u+"%"},a.isDisplay=0!==s,a.startTime==t.startTime&&(a.style["border-bottom-left-radius"]="4px",a.style["border-top-left-radius"]="4px"),a.endTime==t.endTime?(a.style["border-bottom-right-radius"]="4px",a.style["border-top-right-radius"]="4px"):a.style["border-right"]="1px solid rgba(255, 255, 255, .5)",e.timeObject&&n.compareTimeObject(a.startTime,e.timeObject.startTime)&&!n.compareTimeObject(a.startTime,e.timeObject.endTime)?a.isOnLeave=!0:a.isOnLeave=!1}function L(e,t,a){var r=n.getCurrentTime(),o=n.isShowCurrentTime(t,a),s=!1;angular.forEach(e.jobs,function(e){e.isInFuture=s,o&&e.status===i.inProgress.value&&n.compareTimeObject(r,e.startTime)&&n.compareTimeObject(e.endTime,r)&&(s=!0)})}function A(e,t,i){var r=n.isShowCurrentTime(e,t),o=n.checkIsToDay(i);if(r&&o){return{left:n.getPercentageFromDistance(e,n.getCurrentTime(),e,t)+a.percentagePerJob+"%"}}return null}function $(e){var t=!1;angular.forEach(e.jobs,function(n){e.status=n.status,n.status===i.inProgress.value&&(t=!0)}),t&&(e.status=i.inProgress.value)}function I(e,t){if(e.startTime){var n=60*t.hour+t.minute,a=n-U(e.startTime);e.startTime=N(e.startTime,a),e.endTime=N(e.endTime,a),angular.forEach(e.jobs,function(e){e.startTime=N(e.startTime,a),e.endTime=N(e.endTime,a)})}else e.startTime=x(t),angular.forEach(e.jobs,function(e){e.startTime=x(t),t.hour+=1,e.endTime=x(t)}),e.endTime=x(t)}function M(e,t){var n=angular.copy(e),a=[];return angular.forEach(n.jobs,function(e){a.push(P(e))}),{driverId:t,request:P(n),jobs:a}}function w(e,t,a){n.sortByStartTime(e.jobs)
;var i=U(t.startTime),r=U(t.endTime),o=60*a-(r-i),s=!1;angular.forEach(e.jobs,function(e){s&&(e.startTime=N(e.startTime,o),e.endTime=N(e.endTime,o)),e.id===t.id&&(e.endTime=N(e.endTime,o),s=!0)}),e.endTime=e.jobs[e.jobs.length-1].endTime}function q(e,t,n){var a=angular.copy(e);w(a,t,n);var i=[];return angular.forEach(a.jobs,function(e){i.push(P(e))}),{request:P(a),jobs:i}}function P(e){var t=n.getTimeObject(e.startTime),a=n.getTimeObject(e.endTime),i=e.scheduledStartDate?new Date(e.scheduledStartDate):new Date;i.setHours(t.hour,t.minute,0,0);var r=e.scheduledStartDate?new Date(e.scheduledStartDate):new Date;return r.setHours(a.hour,a.minute,0,0),{id:e.id,scheduledStartDate:i,scheduledEndDate:r}}function x(e){return e.hour+":"+e.minute}function U(e){var t=n.getTimeObject(e);return 60*t.hour+t.minute}function N(e,t){var n=U(e)+t,a={minute:n%60};return a.hour=(n-a.minute)/60,x(a)}function B(e){var t=[];return angular.forEach(e,function(e){$(e),t.push({id:e.id,type:e.type,referenceId:e.referenceId,jobs:F(e.jobs),jobSheets:e.jobSheets,driver:e.driver?e.driver.firstName+" "+e.driver.lastName:"",status:e.status})}),t}function E(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,name:e.firstname+" "+e.lastname,amAvailability:e.amAvailability,pmAvailability:e.pmAvailability,requests:O(e.requests)})}),t}function R(e){return{id:e.id,status:e.status,pickupAddress:e.pickupAddress,deliveryAddress:e.deliveryAddress,vehiclePlateNumber:e.vehiclePlateNumber,clientName:e.clientName,clientContact:e.clientContact,startTime:t("date")(new Date(e.scheduledStartDate),"H:mm"),endTime:t("date")(new Date(e.scheduledEndDate),"H:mm"),tasks:e.tasks,scheduledStartDate:e.scheduledStartDate,scheduledEndDate:e.scheduledEndDate}}function F(e){var t=[];return angular.forEach(e,function(e){t.push(R(e))}),t}function H(e){return{id:e.id,type:e.type,startTime:t("date")(new Date(e.scheduledStartDate),"H:mm"),endTime:t("date")(new Date(e.scheduledEndDate),"H:mm"),jobs:F(e.jobs),scheduledStartDate:e.scheduledStartDate,scheduledEndDate:e.scheduledEndDate}}function O(e){var t=[];return angular.forEach(e,function(e){t.push(H(e))}),t}var z=r.serviceUrl+"/api";return{getDriverTimeLineByCriteria:u,getRequestByCriteria:c,getTaskByCriteria:l,assignRequest:d,createTask:m,updateTask:p,assignTask:h,unAssignTask:g,uploadDocument:f,saveTimeDuration:v,populateStyleForDriver:y,getAllBranchLocation:b,getDriverByBranchLocation:T,populateStyleForRequest:j,checkJobInCurrentTime:L,initStyleForCurrentTime:A,getRequestStatusFromJob:$,getAssignRequestData:M,populateTimeForRequestAfterDrop:I,setDuration:w,getDurationData:q,convertListRequestSearch:B,convertListDriverTimeLine:E}}angular.module("main.module").factory("dashboardService",e),e.$inject=["$http","$filter","timeService","calendarSetting","jobStatus","systemSetting","driverUnAvailable","driverStatus"]}();