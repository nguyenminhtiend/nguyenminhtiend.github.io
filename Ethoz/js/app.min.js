!function(){"use strict";function t(t,e){e.hashPrefix(""),t.when("/",{redirectTo:"/dashboard"}).otherwise({redirectTo:"/"})}function e(t,e,n){t.$on("$locationChangeStart",function(t,e,n){}),t.$on("$routeChangeSuccess",function(){e.current.title?document.title="Ethoz - "+e.current.title:document.title="Ethoz"})}angular.module("main.module",["ngRoute","ui.bootstrap","ngMap","ngDraggable","ui.bootstrap.contextMenu","dashboard.module"]).config(t).run(e),t.$inject=["$routeProvider","$locationProvider"],e.$inject=["$rootScope","$route","$location"]}(),function(){"use strict";angular.module("main.module").constant("events",{RE_RENDER_CALENDAR:"RE_RENDER_CALENDAR"}).constant("calendarSetting",{startTime:12,sizeHour:6,percentagePerJob:12.5})}(),function(){"use strict";function t(t){t.when("/dashboard",{title:"Dashboard",controller:"DashboardController",templateUrl:"app/views/dashboard/dashboard.html",controllerAs:"vm"})}function e(t,e,n){function r(){i(),o(),u()}function i(){c.timeSetting={startTime:t.startTime,sizeHour:t.sizeHour},c.calendarViewMode=!0,c.currentDate=new Date,c.status={completed:"completed",pending:"pending",unassign:"unassign"}}function o(){c.drivers=[];for(var t=0;t<3;t++)c.drivers.push({id:t,name:"Driver "+t,jobs:[{id:t+"1",title:"Replacement",startTime:"12",endTime:"13",status:c.status.completed},{id:t+"2",title:"Replacement",startTime:"14",endTime:"15",status:c.status.pending},{id:t+"3",title:"Replacement",startTime:"16",endTime:"18:00",status:c.status.unassign}]});c.drivers.push({id:4,name:"Driver 4",jobs:[{id:"41",title:"On Leave Whole Day - 1 Job Assigned",startTime:"4",endTime:"20",status:c.status.unassign}]}),c.drivers.push({id:5,name:"Driver 5",jobs:[{id:"51",title:"MICE",startTime:"4",endTime:"20",status:c.status.pending}]})}function a(){u()}function s(t,e){for(var n=0;n<c.drivers.length;n++)for(var r=0;r<c.drivers[n].jobs.length;r++)c.drivers[n].jobs[r].id===t.id&&c.drivers[n].jobs.splice(r,1);for(var n=0;n<c.drivers.length;n++)c.drivers[n].id===e&&c.drivers[n].jobs.push(t);u()}function u(){c.currentTimeStyleDisplay=e.initStyleForCurrentTime(c.timeSetting.startTime,c.timeSetting.sizeHour,c.currentDate),angular.forEach(c.drivers,function(t){angular.forEach(t.jobs,function(t){e.initStyleForJob(t,c.timeSetting.startTime,c.timeSetting.sizeHour),n.checkIsToDay(c.currentDate)?e.checkJobInCurrentTime(t,c.timeSetting.startTime,c.timeSetting.sizeHour):t.futureJobStyle=null}),t.currentTimeStyles=c.currentTimeStyleDisplay})}var c=this;c.reAssignDriver=s,c.reRenderCalendar=a,r()}angular.module("dashboard.module",["ngRoute"]).config(t).controller("DashboardController",e),t.$inject=["$routeProvider"],e.$inject=["calendarSetting","dashboardService","timeService"]}(),function(){"use strict";function t(t,e){var n=this;n.data=e,n.ok=function(e){t.close(e)},n.cancel=function(){t.dismiss("cancel")}}angular.module("main.module").controller("ModalInstanceController",t),t.$inject=["$uibModalInstance","data"]}(),function(){"use strict";function t(){}angular.module("main.module").component("headerPage",{bindings:{},templateUrl:"app/components/headerPage/headerPage.html",controller:t,controllerAs:"vm"}),t.$inject=[]}(),function(){"use strict";function t(t){function e(){i.ranges=[],i.textHours=[];for(var e=0;e<i.timeSetting.sizeHour;e++)i.ranges.push(e+i.timeSetting.startTime),i.textHours.push(t.timeToStringMaker(e+i.timeSetting.startTime));i.textHours.push(t.timeToStringMaker(i.timeSetting.startTime+i.timeSetting.sizeHour))}function n(){i.timeSetting.startTime+=1,e(),i.timeChange()}function r(){i.timeSetting.startTime-=1,e(),i.timeChange()}var i=this;i.next=n,i.back=r,i.$onInit=function(){e()}}angular.module("main.module").component("timeControl",{bindings:{timeSetting:"=",timeChange:"&",currentDate:"<",currentTimeStyleDisplay:"<"},templateUrl:"app/components/dashboard/timeControl/timeControl.html",controller:t,controllerAs:"vm"}),t.$inject=["timeService"]}(),function(){"use strict";function t(t,e){function n(){r.draps=[];for(var t=r.timeSetting.startTime,e=0,n=2,i=t;i<r.timeSetting.startTime+r.timeSetting.sizeHour;i++)r.draps.push({style:{left:12.5*n/2+"%"},hour:i,minute:e}),n++,0!=e?30==e&&(e=0):(i--,e=30)}var r=this;r.$onInit=function(){n()},r.status={completed:"completed",pending:"pending",unassign:"unassign"},r.onDropComplete=function(t,e,n,i){if(t){var o=angular.copy(t),a=n.hour+":"+n.minute,s=n.hour+1+":"+n.minute;o.startTime=a,o.endTime=s,r.reAssignDriver({job:o,driverId:i})}}}angular.module("main.module").component("driverChartTime",{bindings:{driver:"=",timeSetting:"<",isTaskActive:"<",reAssignDriver:"&",currentDate:"="},templateUrl:"app/components/dashboard/driverChartTime/driverChartTime.html",controller:t,controllerAs:"vm"}),t.$inject=["$scope","timeService"]}(),function(){"use strict";function t(t,e){function n(t,e){r.currentJob=e,r.map.showInfoWindow("job-info",e.id)}var r=this;r.showDetail=n,r.$onInit=function(){t.getMap().then(function(t){r.map=t}),r.status={completed:"completed",pending:"pending",notstart:"notstart"},e(function(){r.jobs=[{id:"123",plateNo:"",address:"20 Ubi Avenue 4, Singapore",title:"Test Driver",status:r.status.notstart,driver:"Latif",label:{text:"Latif",color:"white",fontSize:"12px"}},{id:"633",plateNo:"SGR 1451 SDG 6496",address:"Ethoz Group Ltd., Tampines Street 92, Singapore",title:"Replacement",status:r.status.pending,label:{text:"Lisheng",color:"white",fontSize:"12px"}}]},2e3)},r.placeChanged=function(){r.place=this.getPlace(),r.map.setCenter(r.place.geometry.location)},r.click=function(){alert("6236236")},r.icon={url:"./img/driver.png"}}angular.module("main.module").component("jobOnMap",{bindings:{},templateUrl:"app/components/dashboard/jobOnMap/jobOnMap.html",controller:t,controllerAs:"vm"}),t.$inject=["NgMap","$timeout"]}(),function(){"use strict";function t(t,e){function n(){var n=e.checkIsToDay(a.currentDate)?"Today":t("date")(a.currentDate,"EEE");a.dateFormat=n+", "+o(a.currentDate.getDate())+" "+t("date")(a.currentDate,"MMM")+", "+a.currentDate.getFullYear()}function r(){a.currentDate.setDate(a.currentDate.getDate()+1),n(),a.dateChange()}function i(){a.currentDate.setDate(a.currentDate.getDate()-1),n(),a.dateChange()}function o(t){return t%20==1||t%30==1?t+"st":t%20==2||t%30==2?t+"nd":t%20==3||t%30==3?t+"rd":t+"th"}var a=this;a.next=r,a.previous=i,a.$onInit=function(){n()}}angular.module("main.module").component("dateControl",{bindings:{currentDate:"=",dateChange:"&"},templateUrl:"app/components/dashboard/dateControl/dateControl.html",controller:t,controllerAs:"vm"}),t.$inject=["$filter","timeService"]}(),function(){"use strict";function t(){var t=this;t.$onInit=function(){}}angular.module("main.module").component("filterDashboard",{bindings:{calendarViewMode:"="},templateUrl:"app/components/dashboard/filterDashboard/filterDashboard.html",controller:t,controllerAs:"vm"}),t.$inject=[]}(),function(){"use strict";function t(){var t=this;t.onDragComplete=function(e,n,r){t.todayJobs.splice(r,1)},t.$onInit=function(){t.status={completed:"completed",pending:"pending",unassign:"unassign"},t.todayJobs=[{id:"123",plateNo:"",address:"20 Ubi Avenue 4, Singapore",title:"Test Driver",status:t.status.unassign,driver:""},{id:"633",plateNo:"SGR 1451 SDG 6496",address:"Ethoz Group Ltd., Tampines Street 92, Singapore",title:"Replacement",status:t.status.pending,driver:"Razif"},{id:"3734",plateNo:"SGR 1451 SDG 6496",address:"Ethoz Group Ltd., Tampines Street 92, Singapore",title:"Replacement",status:t.status.completed,driver:"Meng"}]}}angular.module("main.module").component("jobTab",{bindings:{},templateUrl:"app/components/dashboard/jobTab/jobTab.html",controller:t,controllerAs:"vm"}),t.$inject=[]}(),function(){"use strict";function t(t){function e(){var e={updateItem:{}};t.createPopup({templateUrl:"app/components/dashboard/jobCell/setDurationModal.html",size:"md",data:{}},e)}function n(){var e={updateItem:{}};t.createPopup({templateUrl:"app/components/dashboard/jobCell/addTaskModal.html",size:"md",data:{}},e)}var r=this;r.status={completed:"completed",pending:"pending",unassign:"unassign"},r.$onInit=function(){r.menuOptions=[["Set duration",e],null,["Add task",n],null,["Add petrol card",function(t,e,n,r,i){alert("Add petrol card")}]],r.dynamicPopover={content:"Hello, World!",templateUrl:"myPopoverTemplate.html",title:"Title"}},r.onDropComplete=function(t,e){alert("Assign task to job")}}angular.module("main.module").component("jobCell",{bindings:{job:"=",isTaskActive:"<"},templateUrl:"app/components/dashboard/jobCell/jobCell.html",controller:t,controllerAs:"vm"}),t.$inject=["modalService"]}(),function(){"use strict";function t(){var t=this;t.onDragComplete=function(e,n,r){t.tasks.splice(r,1)},t.$onInit=function(){t.status={completed:"completed",pending:"pending",unassign:"unassign"},t.tasks=[{id:"123",requestNo:"46943435",description:"Pick Lisheng up from 20 Ubi Avenue 4, Singapore. Contact 68203968",status:t.status.unassign,driver:""},{id:"633",requestNo:"46943435",description:"Pick Lisheng up from Ethoz Group Ltd., Tampines Street 92, Singapore. Contact 68203968",status:t.status.pending,driver:"Razif"},{id:"3734",requestNo:"46943435",description:"Pick Lisheng up from Ethoz Group Ltd., Tampines Street 92, Singapore. Contact 68203968",status:t.status.completed,driver:"Lisheng"}]}}angular.module("main.module").component("taskTab",{bindings:{},templateUrl:"app/components/dashboard/taskTab/taskTab.html",controller:t,controllerAs:"vm"}),t.$inject=[]}(),function(){"use strict";function t(t){function e(e){return t("orderBy")(e,function(t){return t.startTime},!1,r)}function n(t){var e=t.split(":"),n={hour:parseInt(e[0])};return n.minute=e.length>1?parseInt(e[1]):0,n}function r(t,e){if(!Number.isInteger(t.value)&&!Number.isInteger(e.value)){var r=n(t.value),i=n(e.value);return r.hour>i.hour||r.hour==i.hour&&r.minute>i.minute}}var i={sortByStartTime:e,getTimeObject:n};return i}angular.module("main.module").factory("utilityService",t),t.$inject=["$filter"]}(),function(){"use strict";function t(t){function e(e,n,r){var i=t.open({animation:!0,templateUrl:e.templateUrl,controller:"ModalInstanceController",controllerAs:"vm",size:e.size,backdrop:"static",resolve:{data:function(){return e.data},readOnly:function(){return e.readOnly}}});i.result.then(function(t){n[t]()},r)}var n={createPopup:e};return n}angular.module("main.module").factory("modalService",t),t.$inject=["$uibModal"]}(),function(){"use strict";function t(t){function e(t,e){var n=new Date,r=n.getHours(),i=n.getMinutes();return!(r<t||r>t+e||r===t+e&&i>0)}function n(t){var e=new Date;return t.setHours(0,0,0,0)==e.setHours(0,0,0,0)}function r(t,e,n,r){var o=a(t.toString()),s=a(e),u=i(s,n,r)-i(o,n,r);return d*u/60}function i(t,e,n){var r=t.hour,i=t.minute;return r<e&&(r=e,i=0),(r>e+n||r===e+n&&i>0)&&(r=e+n,i=0),60*r+i}function o(e){return t("orderBy")(e,function(t){return t.startTime},!1,c)}function a(t){var e=t.split(":"),n={hour:parseInt(e[0])};return n.minute=e.length>1?parseInt(e[1]):0,n}function s(){var t=new Date;return t.getHours()+":"+t.getMinutes()}function u(){return t("date")(new Date,"h:mm a")}function c(t,e){if(!Number.isInteger(t.value)&&!Number.isInteger(e.value)){var n=a(t.value),r=a(e.value);return n.hour>r.hour||n.hour==r.hour&&n.minute>r.minute}}function l(t,e){var n=a(t),r=a(e);return n.hour>r.hour||n.hour==r.hour&&n.minute>r.minute}function m(t){return 0===t||24===t?"12 AM":12===t?t+" PM":t>12?t-12+" PM":t+" AM"}var d=12.5,p={sortByStartTime:o,getTimeObject:a,getCurrentTime:s,getPercentageFromDistance:r,isShowCurrentTime:e,getCurrentTimeText:u,checkIsToDay:n,compareTimeObject:l,timeToStringMaker:m};return p}angular.module("main.module").factory("timeService",t),t.$inject=["$filter"]}(),function(){"use strict";function t(t,e){function n(n,r,i){var o=t.getPercentageFromDistance(n.startTime,n.endTime,r,i);n.style={width:o+"%",left:t.getPercentageFromDistance(r,n.startTime,r,i)+e.percentagePerJob+"%"},n.isDisplay=0!==o}function r(n,r,i){var o=t.getCurrentTime(),a=t.isShowCurrentTime(r,i);if(a&&t.compareTimeObject(o,n.startTime)&&t.compareTimeObject(n.endTime,o)){var s=t.getPercentageFromDistance(o,n.endTime,r,i);n.futureJobStyle={width:s+"%",left:t.getPercentageFromDistance(r,o,r,i)+e.percentagePerJob+"%"}}}function i(n,r,i){var a=t.isShowCurrentTime(n,r),s=t.checkIsToDay(i);if(a&&s){var u=t.getPercentageFromDistance(n,t.getCurrentTime(),n,r)+e.percentagePerJob;return{left:u-o/2+"%"}}return null}var o=8,a={initStyleForJob:n,checkJobInCurrentTime:r,initStyleForCurrentTime:i};return a}angular.module("main.module").factory("dashboardService",t),t.$inject=["timeService","calendarSetting"]}();