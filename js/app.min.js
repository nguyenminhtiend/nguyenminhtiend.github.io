!function(){"use strict";function e(e){e.when("/",{redirectTo:"/customers"}).otherwise({redirectTo:"/"})}function t(e,t,n,o){var i=o.getCurrentUser();i?e.currentUser=i:n.path("/login"),e.$on("$locationChangeStart",function(e,i,r){var a=n.path(),l=t.routes[a];if(l&&l.authorize)return o.isAuthenticated()?void(o.isAuthorized(l.authorize)||n.path("/login")):void n.path("/login")}),e.$on("$routeChangeSuccess",function(){t.current&&(e.hideHeader=t.current.hideHeader,e.category=t.current.category),t.current.title?document.title="ST Logistics - "+t.current.title:document.title="ST Logistics"})}function n(e){e.interceptors.push("httpInterceptor")}angular.module("main.module",["ngRoute","ngAnimate","ui.bootstrap","LocalStorageModule","ui.bootstrap.datetimepicker","toastr","ngTouch","ngSanitize","angularjs-dropdown-multiselect","hljs","ngFileUpload","customer.module","spAdminUser.module","adminUser.module","account.module","milkRun.module","log.module","report.module","allLocations.module","profile.module","adhoc.module"]).config(n).config(e).run(t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","$route","$location","authService"],n.$inject=["$httpProvider"]}(),function(){"use strict";var e={};window&&Object.assign(e,window.env),angular.module("main.module").constant("systemSetting",{serviceUrl:e.apiUrl}).constant("systemRole",{SuperAdmin:"SuperAdmin",Admin:"Admin",User:"User"}).constant("setItemPerPage",[{value:10,text:"10 entities"},{value:20,text:"20 entities"},{value:50,text:"50 entities"},{value:100,text:"100 entities"}]).constant("pageName",{ADHOC_TRANSACTIONS:"AdhocTransactions",MILKRUN_TRANSACTIONS:"MilkrunTransactions",USERS:"Users",CLIENTS:"Customers",JOBTYPES:"Jobtypes",LOCATIONS:"Locations",REPORTS:"Reports",LOGS:"Logs",ALL_LOCATIONS:"AllLocations"}).constant("departments",{PSS:{id:1,name:"PSS"},Healthcare:{id:2,name:"Healthcare"}}).constant("pricingType",{Adhoc:1,AdhocExpres:2,MilkRun:3}).constant("weightCategory",{ThreeKg:0,FourKg:1,FiveKg:2,TenKg:3,TwentyKg:4,Extra:5}).constant("milkRunTypes",{none:0,oneToOne:1,oneToMany:2,manyToOne:3}).constant("adhocTypes",{none:0,oneToOne:1,oneToMany:2,manyToOne:3}).constant("milkRunFrequency",{daily:{value:0,display:"Daily"},twiceADay:{value:1,display:"Twice a day"},weekly:{value:2,display:"Weekly"}}).constant("days",{monday:{text:"M",value:1,display:"Monday"},tuesday:{text:"T",value:2,display:"Tuesday"},wednesday:{text:"W",value:3,display:"Wednesday"},thursday:{text:"T",value:4,display:"Thursday"},friday:{text:"F",value:5,display:"Friday"}}).constant("milkRunAdditionals",{saturdays:{value:6,display:"Saturdays"},sundays:{value:0,display:"Sundays"},afterOfficeHours:{value:2,display:"After Office Hours"},publicHolidays:{value:3,display:"Public Holidays"}}).constant("milkRunWeight",{upTo5kg:{id:7,text:"Up to 5kg"},from5To10kg:{id:8,text:"5 - 10kg"},from10To30kg:{id:9,text:"10 - 30kg"},from30To60kg:{id:10,text:"30 - 60kg"},from60To100kg:{id:11,text:"60 - 100kg"}}).constant("milkRunProgress",{chosenMilkRunType:1,collectionPoint:2,deliveryPoint:3,remark:4,confirmOrder:5}).constant("jobStatusType",{pendingApproval:{value:1,display:"Pending Approval"},rejected:{value:2,display:"Rejected"},accepted:{value:3,display:"Accepted"},delivered:{value:4,display:"Delivered"},deliveryAccepted:{value:5,display:"Delivery Accepted"},open:{value:6,display:"Open"},pendingAssignment:{value:7,display:"Pending Assignment"},operating:{value:8,display:"Operating"},partiallyDelivered:{value:9,display:"Partially Delivered"},fullyDelivered:{value:10,display:"Fully Delivered"},fullyRejected:{value:11,display:"Fully Rejected"},rescheduled:{value:12,display:"Rescheduled"},deactivated:{value:13,display:"Deactivated"}}).constant("deliveryPointCategory",{one:{value:1,display:"A to 1 point"},two:{value:2,display:"A to 2 point"},five:{value:3,display:"A to 5 point"},ten:{value:4,display:"A to 10 point"},twenty:{value:5,display:"A to 20 point"},fifty:{value:6,display:"A to 50 point"},oneHundred:{value:7,display:"A to 100 point"},fourHundred:{value:8,display:"A to 400 point"}}).constant("adhocWeightCategory",{adhocUptoThreeKg:{value:1,display:"Up to 3kg"},adhocThreeToFourKg:{value:2,display:">3 - 4kg"},adhocFourToFiveKg:{value:3,display:">4 - 5kg"},adhocFiveToTenKg:{value:4,display:">5 - 10kg"},adhocTenToTwentyKg:{value:5,display:">10 - 20kg"},adhocAboveTwenty:{value:6,display:">20kg"}}).constant("milkRunWeightCategory",{milkrunUptoFiveKg:{value:7,display:"Up to 5kg"},milkrunFiveToTenKg:{value:8,display:"> 5 - 10kg"},milkrunThirtyToSixty:{value:9,display:"> 10 - 30kg"},milkrunTenToThirtyKg:{value:10,display:"> 30 - 60kg"},milkrunSixtyToHundred:{value:11,display:"> 60 - 100kg"}}).constant("healthCareWeightCategory",{adhocDocument:{value:12,display:"DOCUMENTS (X-Rays, case notes, medical records etc)"},adhocPharmaceutical:{value:13,display:"HOME DELIVERY (Pharmaceutical items)"},adhocSingpostMail:{value:14,display:"SINGPOST MAILS"},adhocParcel:{value:15,display:"PARCELS"},adhocInstrument:{value:16,display:"SOLID INSTRUMENTS"},adhocSpecimen:{value:17,display:"BLOOD SPECIMEN, HUMAN/ANIMAL SPECIMEN"}}).constant("healthCareDeliveryTiming",{officeHour:{value:4,display:"Office Hours"},officeHourExpress:{value:5,display:"Office Hour Express"},weekdayEvening:{value:6,display:"Weekday Evening"},weekdayEveningExpress:{value:7,display:"Weekday Evening Express"},weekend:{value:8,display:"Last Night (Sat, Sun, Public Holidays)"}}).constant("adhocProgress",{chosenAdhocType:1,collectionPoint:2,deliveryPoint:3,addItem:4,remark:5,confirmOrder:6}).constant("adhocPSSServiceType",{officeHourDelivery:{value:1,display:"Office Hour Delivery"},weekdayEvening:{value:2,display:"Weekday Evening"},express:{value:3,display:"Express"},nonWorkingday:{value:4,display:"Non Working Day"}}).constant("adhocHealthCareServiceType",{hCOfficeHour:{value:5,display:"Weekday Office Hour"},hCOfficeHourExpress:{value:6,display:"Weekday Office Hour Express"},hCWeekdayEvening:{value:7,display:"Weekday Evening"},hCWeekdayEveningExpress:{value:8,display:"Weekday Evening Express"},hCWeekend:{value:9,display:"Weekend, Weekend Evening & Public Holiday"}}).constant("uomPSS",["Document","Each","Box","Carton","Pallet","Pack"]).constant("uomHealthCare",["Bag","Bottle","Box","Can","Carton","Piece","Lot","Each","Packet","Set","Tin","Tube","Pallet"]).constant("itemsHealthCare",["Documents (X-Rays, case notes, medical records etc)","Home delivery: Pharmaceutical items","Singpost Mails","Parcels","Solid Instruments","Blood/Blood Specimen/Human or Animal Specimen"]).constant("jobGridType",{milkRunJob:"milkRunJob",milkRunTransaction:"milkRunTransaction",adhocJob:"adhocJob",adhocTransaction:"adhocTransaction"}).constant("jobStatus",{pendingApproval:{value:1,display:"Pending Approval"},rejected:{value:2,display:"Rejected"},accepted:{value:3,display:"Accepted"},delivered:{value:4,display:"Delivered"},deactivated:{value:5,display:"Deactivated"}}).constant("taskStatus",{pendingCollection:{value:1,display:"Pending Collection"},collecting:{value:2,display:"Collecting"},collected:{value:3,display:"Collected"},collectionFailed:{value:4,display:"Collection Failed"},delivering:{value:5,display:"Delivering"},delivered:{value:5,display:"Delivered"},deliverFailed:{value:5,display:"Delivery Failed"},pendingReturn:{value:5,display:"Pending Return"},returning:{value:5,display:"Returning"},returned:{value:5,display:"Returned"}})}(),function(){"use strict";function e(e){e.when("/customers",{title:"Client Management",category:"Customers",controller:"CustomerController",templateUrl:"app/components/customer/customers.html",controllerAs:"vm",authorize:["SuperAdmin","Admin"]}).when("/customers/create",{title:"Create new client",category:"Customers",controller:"CustomerDetailController",templateUrl:"app/components/customer/detail.html",controllerAs:"vm",authorize:["Admin"]}).when("/customers/detail/:id",{title:"Client detail",category:"Customers",controller:"CustomerDetailController",templateUrl:"app/components/customer/detail.html",controllerAs:"vm",authorize:["SuperAdmin","Admin"]}).when("/example",{title:"Client detail",category:"Customers",controller:"ExampleController",templateUrl:"app/components/customer/example.html",controllerAs:"vm"})}function t(e,t,n,o){function i(){r(),a()}function r(){s.options={sortColumn:"",sortAscending:!0,itemPerPage:20,currentPage:1,searchTerm:""},s.gridConfig={onClickRowDetail:l,columns:[{name:"sapCode",display:"SAP Code",columnNameSort:"sAPCode",css:"col-md-2"},{name:"organizationCode",display:"Organization Code",columnNameSort:"organizationCode",css:"col-md-2"},{name:"name",display:"Organization Name",columnNameSort:"name",css:"col-md-2"},{name:"clientType",display:"Client Type",columnNameSort:"departmentId",css:"col-md-2"},{name:"address",display:"Address",columnNameSort:"address",css:"col-md-4"}]},e.currentUser.role===o.Admin&&s.gridConfig.columns.splice(3,1)}function a(){s.isGridLoading=!0,n.getCustomerByCriteria(s.options).then(function(e){s.options.totalItems=e.data.totalCount,s.customers=n.convertListCustomer(e.data.customers),s.isGridLoading=!1})}function l(e){t.path("/customers/detail/"+e.id)}var s=this;s.systemRole=o,s.getCustomerByCriteria=a,i()}function n(e,t,n,o,i,r,a){function l(){var n=t.id;n?(c.isLoading=!0,i.getCustomerById(n).then(function(e){c.clientDetail=i.convertCustomer(e.data),c.isLoading=!1}),c.viewMode=!0):(c.clientDetail={department:{name:e.currentUser.department},clientTypeId:o[e.currentUser.department].id,users:[],pricings:[],address:{}},c.viewMode=!1)}function s(){c.clientDetail.contractEndDate&&c.clientDetail.cutOffTimeForSameDayPickupAndDelivery&&c.clientDetail.cutOffTimeForSameDayPickupAndNextDayDelivery&&(c.isLoading=!0,i.saveCustomer(c.clientDetail).then(function(e){c.isLoading=!1;var t=c.clientDetail.id?"The client has been updated successfully.":"The client has been created successfully.";r.success(t),n.path("/customers")}))}var c=this;c.systemRole=a,c.pssAdhocPricing={},c.healthCareAdhocPricing={},c.newUser={},c.saveCustomer=s,l()}function o(){var e=this;e.options={itemPerPage:20,currentPage:1},e.gridConfig={columns:[{name:"customer",display:"Customer"},{name:"createdDate",display:"Created date"},{name:"frequency",display:"Frequency"},{name:"status",display:"Status"},{name:"collectionPoints",display:"Collection point"},{name:"deliveryPoints",display:"Delivery point"}]},e.lists=[];for(var t=0;t<10;t++)e.lists.push({customer:"Costal Command",createdDate:new Date,frequency:"Weekly",status:"Picking up",collectionPoints:"10 Brani Way Singapore 236236",deliveryPoints:"10 Brani Way Singapore 236236"})}angular.module("customer.module",["ngRoute"]).config(e).controller("CustomerController",t).controller("CustomerDetailController",n).controller("ExampleController",o),e.$inject=["$routeProvider"],t.$inject=["$rootScope","$location","customerService","systemRole"],n.$inject=["$rootScope","$routeParams","$location","departments","customerService","toastr","systemRole"],o.$inject=[]}(),function(){"use strict";function e(e,t,n,o,i,r){function a(){l()}function l(){k.milkRunPricingExist=s(t.MilkRun)>=0,k.adhocPricingExist=s(t.Adhoc)>=0,k.adhocExpresPricingExist=s(t.AdhocExpres)>=0}function s(e){for(var t=0;t<k.listPricing.length;t++)if(k.listPricing[t].pricingType===e)return t;return-1}function c(t){e.currentUser.department===i.PSS.name?u(t):d(t)}function u(e){k.adhocPricingModel=h(e);var t=s(e);t<0&&P(k.adhocPricingModel),y(m,k.adhocPricingModel,"app/components/customer/pricing/adhocPricingModal.html")}function d(e){k.adhocHealthCarePricingModel=h(e),y(p,k.adhocHealthCarePricingModel,"app/components/customer/pricing/healthCarePricingModal.html")}function m(){C(k.adhocPricingModel)}function p(){C(k.adhocHealthCarePricingModel)}function g(){k.milkRunPricingModel=h(t.MilkRun),y(f,k.milkRunPricingModel,"app/components/customer/pricing/milkRunPricingAdvanceModal.html")}function f(){C(k.milkRunPricingModel)}function v(e,t){if(k[t])k[t]=!1,o.createWarningPopup("Please set pricing for this service first!","Warning",null,!0);else{var n=s(e);n>=0&&k.listPricing.splice(n,1)}}function h(e){var t=s(e);return t>=0?angular.copy(k.listPricing[t]):{pricingType:e}}function y(e,t,n){var i={setPricing:e};o.createPopup({templateUrl:n,size:"lg",data:t},i)}function C(e){var t=s(e.pricingType);t>=0?k.listPricing[t]=e:k.listPricing.push(e),l()}function P(e){e.weightCategories=[];for(var t in r)e.weightCategories.push({weightCategoryId:r[t].value,deliveryTimings:[{deliveryTimingId:1},{deliveryTimingId:2},{deliveryTimingId:3}]})}var k=this;k.listPricing=k.listPricing||[],k.pricingType=t,k.setPricing=c,k.setMilkRunPricing=g,k.checkSetPricing=v,a()}angular.module("customer.module").directive("customerPricing",function(){return{restrict:"E",scope:{viewMode:"=",listPricing:"="},templateUrl:"app/components/customer/pricing/customerPricing.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","pricingType","weightCategory","modalService","departments","adhocWeightCategory"]}(),function(){"use strict";function e(e){function t(){o.newUser={workAddress:{},billingAddresses:[{}]};var t={onCreateOrUpdate:n};e.createPopup({templateUrl:"app/components/customer/user/userDetail.html",size:"lg",data:o.newUser},t)}function n(){o.listUser.push(o.newUser)}var o=this;o.addNewUser=t,o.listUser=o.listUser||[]}angular.module("customer.module").directive("customerUser",function(){return{restrict:"E",scope:{viewMode:"=",listUser:"=",orgCode:"@"},templateUrl:"app/components/customer/user/customerUser.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["modalService"]}(),function(){"use strict";function e(e){e.when("/users",{title:"User management",category:"Users",controller:"SpAdminUserController",templateUrl:"app/components/spAdminUser/users.html",controllerAs:"vm",authorize:["SuperAdmin"]}).when("/users/create",{title:"New admin",category:"Users",controller:"SpAdminUserDetailController",templateUrl:"app/components/spAdminUser/detail.html",controllerAs:"vm",authorize:["SuperAdmin"]}).when("/users/detail/:id",{title:"Admin detail",category:"Users",controller:"SpAdminUserDetailController",templateUrl:"app/components/spAdminUser/detail.html",controllerAs:"vm",authorize:["SuperAdmin"]})}function t(e,t,n){function o(){i(),r()}function i(){l.options={sortColumn:"",sortAscending:!0,itemPerPage:20,currentPage:1,searchTerm:"",department:""},l.gridConfig={onClickRowDetail:a,columns:[{name:"name",display:"Name",columnNameSort:"firstName"},{name:"email",display:"Email",columnNameSort:"email"},{name:"phoneNumber",display:"Contact number",columnNameSort:"phoneNumber"},{name:"departmentName",display:"Department",columnNameSort:"department"}]},l.departments=[{id:"",name:"All"},n.PSS,n.Healthcare]}function r(){l.isGridLoading=!0,t.getAdminUserByCriteria(l.options).then(function(e){l.options.totalItems=e.data.totalCount;var t=e.data.users;angular.forEach(t,function(e){e.name=e.firstName+" "+e.lastName,e.departmentName=e.department.name}),l.users=t,l.isGridLoading=!1})}function a(t){e.path("/users/detail/"+t.id)}var l=this;l.getAdminUserByCriteria=r,o()}function n(e,t,n,o,i,r){function a(){var t=e.id;t?(n.getAdminUserById(t).then(function(e){m.userDetail=e.data,m.isActive=m.userDetail.lockoutEnabled}),m.viewMode=!0):m.viewMode=!1}function l(){m.viewMode=!1}function s(){m.isSaving=!0,n.saveAdminUser(m.userDetail).then(function(e){m.isSaving=!1;var n=m.userDetail.id?"The admin has been updated successfully.":"The admin has been created successfully.";i.success(n),t.path("/users")},function(e){m.isSaving=!1})}function c(){var e=m.userDetail.lockoutEnabled?"Are you sure you want to activate this admin?":"Are you sure you want to deactivate this admin?";r.createWarningPopup(e,"Warning",u)}function u(){n.activateOrDeactivate(m.userDetail).then(function(e){var t=m.userDetail.lockoutEnabled?"The admin has been activated successfully.":"The admin has been deactivated successfully.";m.userDetail.lockoutEnabled=!m.userDetail.lockoutEnabled,i.success(t)})}function d(){n.checkEmailExist(m.userDetail.email).then(function(e){m.emailExist=!0},function(e){m.emailExist=!1})}var m=this;m.departments=o,m.edit=l,m.save=s,m.activateOrDeactivate=c,m.checkEmailExist=d,a()}angular.module("spAdminUser.module",["ngRoute"]).config(e).controller("SpAdminUserController",t).controller("SpAdminUserDetailController",n),e.$inject=["$routeProvider"],t.$inject=["$location","adminUserService","departments"],n.$inject=["$routeParams","$location","adminUserService","departments","toastr","modalService"]}(),function(){"use strict";function e(e){e.when("/login",{title:"Login",controller:"AccountController",templateUrl:"app/components/account/login.html",controllerAs:"vm",hideHeader:!0}).when("/account/forgot",{title:"Forgot password",controller:"AccountController",templateUrl:"app/components/account/forgot.html",controllerAs:"vm",hideHeader:!0}).when("/account/activate",{title:"Activate account",controller:"AccountController",templateUrl:"app/components/account/activate.html",controllerAs:"vm",hideHeader:!0})}function t(e,t,n,o){function i(){return s.email&&s.password?(s.isLoginInProgress=!0,void t.login(s.email,s.password).then(function(e){s.isLoginInProgress=!1,l(e)},function(){s.password="",s.isLoginInProgress=!1,s.wrongPassword=!0})):void(s.wrongPassword=!0)}function r(){n.path("/login")}function a(){return s.email?(console.log("hi"),void t.resetPassword(s.email).then(function(e){s.isSentResetPassword=!0},function(){console.log("fail"),s.isLoginInProgress=!1,s.userNotFound=!0,s.isSentResetPassword=!1})):void(s.wrongPassword=!0)}function l(t){e.currentUser=t,t.role===o.User?n.path("/clientUsers"):n.path("/customers")}var s=this;s.login=i,s.activateAccount=r,s.resetPassword=a}angular.module("account.module",["ngRoute"]).config(e).controller("AccountController",t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","authService","$location","systemRole"]}(),function(){"use strict";function e(e){e.when("/clientUsers",{title:"User Client management",category:"Users",controller:"AdminUserController",templateUrl:"app/components/adminUser/clientUsers.html",controllerAs:"vm",authorize:["Admin","User"]})}function t(e,t,n,o,i){function r(){a(),e.currentUser.role===i.User?n.getClientUserById(e.currentUser.id).then(function(e){p.options.organizationCode=e.data.organizationCode,l()}):l()}function a(){p.options={sortColumn:"",sortAscending:!0,itemPerPage:20,currentPage:1,searchTerm:"",department:e.currentUser.department},p.gridConfig={onClickRowDetail:u,columns:[{name:"name",display:"Name",css:"col-md-2",columnNameSort:"name"},{name:"email",display:"Email",css:"col-md-2",columnNameSort:"email"},{name:"phoneNumber",display:"Contact no",css:"column-user-phoneNumer",columnNameSort:"contact"},{name:"workAddress",display:"Office address",css:"col-md-2",columnNameSort:"workAddress"},{name:"billingAddresses",display:"Billing address",css:"col-md-2",preventSort:!0,htmlDisplay:!0},{name:"organizationCode",display:"Org code",css:"column-user-orgCode",columnNameSort:"organizationCode"},{name:"costCentre",display:"Cost centre",css:"column-user-costCentre",columnNameSort:"costCentre"}]}}function l(){p.isGridLoading=!0,n.getClientUserByCriteria(p.options).then(function(e){p.options.totalItems=e.data.totalCount,p.users=n.convertListUser(e.data.users),p.isGridLoading=!1})}function s(){p.userDetail={};var e={addNewUser:c};d(e)}function c(){p.data.push({name:p.userDetail.firstName+" "+p.userDetail.lastName,email:p.userDetail.email,contactNo:p.userDetail.mobileNumber,officeAddress:p.userDetail.workAddress.postalCode+" "+p.userDetail.workAddress.blockNumber+" "+p.userDetail.workAddress.streetName+" "+p.userDetail.workAddress.unitNumber,billingAddress:p.userDetail.billingAddress.postalCode+" "+p.userDetail.billingAddress.blockNumber+" "+p.userDetail.billingAddress.streetName+" "+p.userDetail.billingAddress.unitNumber,orgCode:"ICA",costCentre:p.userDetail.costCenter})}function u(t){e.currentUser.role!==i.User&&n.getClientUserById(t.id).then(function(e){p.userDetail=e.data;var t={onCreateOrUpdate:m};d(t)})}function d(e){t.createPopup({templateUrl:"app/components/customer/user/userDetail.html",size:"lg",data:p.userDetail},e)}function m(){p.isGridLoading=!0,n.updateClientUser(p.userDetail).then(function(e){o.success("The user has been updated successfully."),l()})}var p=this;p.userDetail={},p.getUserByCriteria=l,p.addNewUser=s,p.openDetailModal=u,r()}angular.module("adminUser.module",["ngRoute"]).config(e).controller("AdminUserController",t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","modalService","clientUserService","toastr","systemRole"]}(),function(){"use strict";function e(e){e.when("/milkruns",{title:"Fixed Run Transactions",category:"MilkrunTransactions",controller:"MilkrunManagementController",templateUrl:"app/components/milkrun/milkruns.html",controllerAs:"vm",authorize:["SuperAdmin","Admin","User"]}).when("/milkrun/create",{title:"Create new Fixed Run",category:"MilkrunTransactions",controller:"MilkRunDetailController",templateUrl:"app/components/milkrun/detail.html",controllerAs:"vm",authorize:["Admin","User"]}).when("/milkrun/detail/:id",{title:"Fixed Run detail",category:"MilkrunTransactions",controller:"MilkRunDetailController",templateUrl:"app/components/milkrun/detail.html",controllerAs:"vm",authorize:["SuperAdmin","Admin","User"]})}function t(e,t,n,o,i){function r(){a(),l()}function a(){u.options={itemPerPage:20,currentPage:1,customer:"",status:"",requestType:""},u.transactionOptions={itemPerPage:20,currentPage:1,customer:"",status:"",requestType:""},u.gridConfig={columns:[{name:"customer",display:"Customer"},{name:"createdDate",display:"Created date"},{name:"frequency",display:"Frequency"},{name:"status",display:"Status"},{name:"collectionPoints",display:"Collection point"},{name:"deliveryPoints",display:"Delivery point"}]},u.gridConfigTransation={columns:[{name:"barcode",display:"Barcode"},{name:"customer",display:"Customer"},{name:"createdDate",display:"Created date"},{name:"status",display:"Status"},{name:"jobDate",display:"Job date"},{name:"collectionPoints",display:"Collection point"},{name:"deliveryPoints",display:"Delivery point"},{name:"vendor",display:"Vendor name"}]}}function l(){u.isLoading=!0,e.getMilkRunByCriteria(u.options).then(function(t){u.listMilkRun=e.convertListMilkRun(t.data.milkRuns),u.options.totalItems=t.data.totalCount,u.isLoading=!1})}function s(){u.isLoading=!0,i.getMilkRunTaskByCriteria(u.transactionOptions).then(function(e){u.listMilkRunTask=i.convertListMilkRunTask(e.data.milkRunTasks),u.transactionOptions.totalItems=e.data.totalCount,u.isLoading=!1})}function c(e){u.isJob=e,u.isJob?l():s()}var u=this;u.isJob=!0,u.jobStatusType=t,u.systemRole=n,u.jobGridType=o,u.getMilkRunByCriteria=l,u.getMilkRunTaskByCriteria=s,u.switchDisplayJob=c,r()}function n(e,t,n,o,i,r,a,l){function s(){var e=t.id;e?(u.viewMode=!0,u.currentProgress=n.confirmOrder,u.isLoading=!0,i.getMilkRunById(e).then(c)):(u.viewMode=!1,u.milkrunDetail={},u.currentProgress=n.chosenMilkRunType)}function c(t){var n=i.convertMilkRun(t.data);e.currentUser.department===a.PSS.name?r.calculateMilkRun(n).then(function(e){i.transferPricing(n,e.data),u.milkrunDetail=n,u.isLoading=!1}).catch(function(e){l.warning("There's no pricing for calculation!"),u.milkrunDetail=n,u.isLoading=!1}):(u.milkrunDetail=n,u.isLoading=!1)}var u=this;u.systemRole=o,u.milkRunProgress=n,s()}angular.module("milkRun.module",["ngRoute"]).config(e).controller("MilkrunManagementController",t).controller("MilkRunDetailController",n),e.$inject=["$routeProvider"],t.$inject=["milkrunService","jobStatusType","systemRole","jobGridType","taskService"],n.$inject=["$rootScope","$routeParams","milkRunProgress","systemRole","milkrunService","pricingService","departments","toastr"]}(),function(){"use strict";function e(e){e.when("/logs",{title:"Logs management",category:"Logs",controller:"LogController",templateUrl:"app/components/log/logs.html",controllerAs:"vm",authorize:["SuperAdmin","Admin"]})}function t(e,t){function n(){o(),i()}function o(){r.options={itemPerPage:20,currentPage:1,dateFrom:"",dateTo:"",role:"",action:"",userSearch:"",descriptionSearch:""},r.roles=[{text:"All",value:""},{text:"Super Admin",value:"SuperAdmin"},{text:"Admin",value:"Admin"},{text:"User",value:"User"}],r.actions=[{text:"All",value:""},{text:"Create",value:"Created"},{text:"Modify",value:"Modified"},{text:"Delete",value:"Deleted"},{text:"Cancel",value:"Cancelled"},{text:"Approve",value:"Approved"},{text:"Reject",value:"Rejected"},{text:"Login",value:"Logged In"}]}function i(){r.isLoading=!0,t.getLogByCriteria(r.options).then(function(e){r.logs=e.data.logs,r.options.totalItems=e.data.totalCount,r.isLoading=!1})}var r=this;r.setItemPerPage=e,r.getLogByCriteria=i,n()}angular.module("log.module",["ngRoute"]).config(e).controller("LogController",t),e.$inject=["$routeProvider"],t.$inject=["setItemPerPage","logService"]}(),function(){"use strict";function e(e){e.when("/reports",{title:"Report management",category:"Reports",controller:"ReportController",templateUrl:"app/components/report/reports.html",controllerAs:"vm",authorize:["SuperAdmin","Admin"]})}function t(e,t){function n(){o(),i()}function o(){r.options={itemPerPage:20,currentPage:1,startDate:"",endDate:"",role:"All",action:"All"},r.roles=[{text:"All",value:"All"},{text:"Super Admin",value:"SuperAdmin"},{text:"Admin",value:"Admin"},{text:"Customer",value:"Customer"}],r.actions=[{text:"All",value:"All"},{text:"Add",value:"Add"},{text:"Edit",value:"Edit"},{text:"Delete",value:"Delete"},{text:"Cancel",value:"Cancel"},{text:"Approve",value:"Approve"},{text:"Reject",value:"Reject"}]}function i(){r.isLoading=!0,e(function(){r.listReport=[];for(var e=0;e<10;e++)r.listReport.push({barcodeNumber:"22309628602",organizationName:"National Library Board",organizationCode:"NLB",department:"PSS",requestorName:"Jeffrey",requestorContact:"9464656546",costCenter:"Cost center 1",requestDateTime:"11/12/2016 10:34",jobType:"Milkrun",collectionAddress:"70 Anson Road, S079905",collectionDateTime:"11/12/2016 10:34",deliveryAddress:"5 Clementi Loop, S128576",deliveryDateTime:"12/10/2016  18:00:00 PM",numberOfItem:"3",itemDescription:"1 x Box 5kg, 2 x File 0.5 kg",itemisedCost:"1 x 28, 2 x 15",additionalCost:"10",totalCost:"68",status:"Confirmed"});r.options.totalItems=175,r.isLoading=!1},1e3)}var r=this;r.setItemPerPage=t,r.getReportByCriteria=i,n()}angular.module("report.module",["ngRoute"]).config(e).controller("ReportController",t),e.$inject=["$routeProvider"],t.$inject=["$timeout","setItemPerPage"]}(),function(){"use strict";function e(e){e.when("/allLocations",{title:"All Locations",category:"AllLocations",controller:"AllLocationsController",templateUrl:"app/components/allLocations/allLocations.html",controllerAs:"vm",authorize:["SuperAdmin"]})}function t(e,t,n){function o(){e.downloadFile()}function i(){e.lastUpdate().then(function(e){var t=new Date(e.data);l.lastUpdate=n("date")(t,"medium","+0800")})}function r(t){e.uploadFile(l.file).then(function(e){console.log("success"),i()},function(e){console.log("fail")})}function a(e){l.file=e}var l=this;l.downloadFile=o,l.uploadFile=r,l.file="",l.onFileSelect=a,i()}angular.module("allLocations.module",["ngRoute"]).config(e).controller("AllLocationsController",t),e.$inject=["$routeProvider"],t.$inject=["allLocationsService","systemSetting","$filter"]}(),function(){"use strict";function e(e){e.when("/profile",{title:"Profile",controller:"ProfileController",templateUrl:"app/components/profile/profiles.html",controllerAs:"vm",authorize:["SuperAdmin","Admin","User"]})}function t(e,t,n,o,i){function r(){a.isLoading=!0;var r;return e.currentUser.role===n.SuperAdmin?void t.path("/customers"):(r=e.currentUser.role===n.User?i.getClientUserById:o.getAdminUserById,void r(e.currentUser.id).then(function(e){a.userDetail=e.data,a.isLoading=!1}))}var a=this;a.systemRole=n,r()}angular.module("profile.module",["ngRoute"]).config(e).controller("ProfileController",t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","$location","systemRole","adminUserService","clientUserService"]}(),function(){"use strict";function e(e){e.when("/adhocs",{title:"Ad Hoc Transactions",category:"AdhocTransactions",controller:"AdhocManagementController",templateUrl:"app/components/adhoc/adhocs.html",controllerAs:"vm",authorize:["SuperAdmin","Admin","User"]}).when("/adhoc/create",{title:"Create new Adhoc Job",category:"AdhocTransactions",controller:"AdhocDetailController",templateUrl:"app/components/adhoc/detail.html",controllerAs:"vm",authorize:["Admin","User"]}).when("/adhoc/detail/:id",{title:"Adhoc Job detail",category:"AdhocTransactions",controller:"AdhocDetailController",templateUrl:"app/components/adhoc/detail.html",controllerAs:"vm",authorize:["SuperAdmin","Admin","User"]})}function t(e,t,n,o){function i(){r(),a()}function r(){c.options={itemPerPage:20,currentPage:1,customer:"",status:"",requestType:""},c.transactionOptions={itemPerPage:20,currentPage:1,customer:"",status:"",requestType:""},c.gridConfig={columns:[{name:"customer",display:"Customer"},{name:"createdDate",display:"Created date"},{name:"requestType",display:"Request type"},{name:"status",display:"Status"},{name:"collectionPoints",display:"Collection point"},{name:"deliveryPoints",display:"Delivery point"}]},c.gridConfigTransation={columns:[{name:"barcode",display:"Barcode"},{name:"customer",display:"Customer"},{name:"createdDate",display:"Created date"},{name:"requestType",display:"Request type"},{name:"status",display:"Status"},{name:"collectionPoint",display:"Collection point"},{name:"pickUpDate",display:"Pick up Date & Time"},{name:"deliveryPoint",display:"Delivery point"},{name:"deliveryDate",display:"Delivery Date & Time"},{name:"vendor",display:"Vendor name"}]}}function a(){c.isLoading=!0,n.getAdhocByCriteria(c.options).then(function(e){c.listJob=n.convertListAdhoc(e.data.jobs),c.options.totalItems=e.data.totalCount,c.isLoading=!1})}function l(){c.isLoading=!0,o.getAdhocTaskByCriteria(c.transactionOptions).then(function(e){c.listTask=o.convertListAdhocTask(e.data.jobTasks),c.options.transactionOptions=e.data.totalCount,c.isLoading=!1})}function s(e){c.isJob=e,c.isJob?a():l()}var c=this;c.isJob=!0,c.jobGridType=e,c.systemRole=t,c.switchDisplayJob=s,c.getJobByCriteria=a,c.getTaskByCriteria=l,i()}function n(e,t,n,o,i,r,a){function l(){var e=t.id;e?(c.viewMode=!0,c.currentProgress=n.confirmOrder,c.isLoading=!0,o.getAdhocById(e).then(s)):(c.viewMode=!1,c.adhocDetail={},c.currentProgress=n.chosenAdhocType)}function s(t){var n=o.convertAdhoc(t.data);e.currentUser.department===i.PSS.name?r.calculateAdhoc(n).then(function(e){r.transferAdhocPricing(n,e.data),c.adhocDetail=n,c.isLoading=!1}).catch(function(e){a.warning("There's no pricing for calculation!"),c.adhocDetail=n,c.isLoading=!1}):(c.adhocDetail=n,c.isLoading=!1)}var c=this;c.adhocProgress=n,l()}angular.module("adhoc.module",["ngRoute"]).config(e).controller("AdhocManagementController",t).controller("AdhocDetailController",n),e.$inject=["$routeProvider"],t.$inject=["jobGridType","systemRole","adhocService","taskService"],n.$inject=["$rootScope","$routeParams","adhocProgress","adhocService","departments","pricingService","toastr"]}(),function(){"use strict";function e(e,t,n,o){function i(){return!!s()}function r(e){var t=s();return!!(t&&e.indexOf(t.role)>-1)}function a(i,r){var a=t.defer(),l=o.serviceUrl+"/api/account/token",s={username:i,password:r};return e.post(l,s).then(function(e){var t={access_token:e.data.accessToken,token_type:e.data.tokenType},o={id:e.data.id,email:e.data.email,role:e.data.role,department:e.data.department,customerId:e.data.customerId,firstName:e.data.firstName,lastName:e.data.lastName};n.set("tokenInfo",t),n.set("userInfo",o),a.resolve(o)},function(e){a.reject()}),a.promise}function l(){n.remove("tokenInfo"),n.remove("userInfo")}function s(){return n.get("userInfo")}function c(n){var i=t.defer(),r=o.serviceUrl+"/api/account/forgetpassword",a={email:n};return e.post(r,a).then(function(e){
var t={message:e.data.messaage};i.resolve(t)},function(e){i.reject()}),i.promise}var u={isAuthenticated:i,isAuthorized:r,login:a,logout:l,getCurrentUser:s,resetPassword:c};return u}angular.module("main.module").factory("authService",e),e.$inject=["$http","$q","localStorageService","systemSetting"]}(),function(){"use strict";function e(e){function t(t,n,o){var i=e.open({animation:!0,templateUrl:t.templateUrl,controller:"ModalInstanceCtrl",controllerAs:"vm",size:t.size,backdrop:"static",resolve:{data:function(){return t.data}}});i.result.then(function(e){n[e]()},o)}function n(t,n,o,i){var r=e.open({animation:!0,templateUrl:"app/directives/commonControls/warningModal/warningModal.html",controller:"ModalInstanceCtrl",controllerAs:"vm",backdrop:"static",resolve:{data:function(){return{message:t,title:n,isHideActionButton:i}}}});r.result.then(function(e){o&&o()})}var o={createPopup:t,createWarningPopup:n};return o}angular.module("main.module").factory("modalService",e),e.$inject=["$uibModal"]}(),function(){"use strict";function e(e,t,n){function o(e){e.headers=e.headers||{};var n=t.get("tokenInfo");return n&&(e.headers.Authorization=n.token_type+" "+n.access_token),e}function i(o){return 401===o.status&&(t.remove("tokenInfo"),t.remove("userInfo"),n.path("/login")),e.reject(o)}var r={request:o,responseError:i};return r}angular.module("main.module").factory("httpInterceptor",e),e.$inject=["$q","localStorageService","$location"]}(),function(){"use strict";function e(e,t){function n(t){return t.id?e.put(l+t.id,t):e.post(l,t)}function o(t){var n=l+"?offset="+(t.currentPage-1)*t.itemPerPage;return n+="&limit="+t.itemPerPage,t.searchTerm&&(n+="&search="+t.searchTerm),t.department&&(n+="&departmentId="+t.department),t.sortColumn&&(n+="&sortBy="+t.sortColumn,n+="&ascending="+t.sortAscending),e.get(n)}function i(t){return e.get(l+t)}function r(t){var n=t.lockoutEnabled?"activate/":"deactivate/";return e.post(l+n+t.id)}function a(t){return e.post(l+"userExists",{email:t})}var l=t.serviceUrl+"/api/adminusers/",s={saveAdminUser:n,getAdminUserByCriteria:o,getAdminUserById:i,activateOrDeactivate:r,checkEmailExist:a};return s}angular.module("main.module").factory("adminUserService",e),e.$inject=["$http","systemSetting"]}(),function(){"use strict";function e(e,t){function n(t){var n=s+"?offset="+(t.currentPage-1)*t.itemPerPage;return n+="&limit="+t.itemPerPage,t.searchTerm&&(n+="&search="+t.searchTerm),t.sortColumn&&(n+="&sortBy="+t.sortColumn,n+="&ascending="+t.sortAscending),e.get(n)}function o(t){return e.get(s+t)}function i(t){return t.id?e.put(s+t.id,t):e.post(s,t)}function r(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,sapCode:e.sapCode,organizationCode:e.organizationCode,name:e.name,clientType:e.department.name,address:e.address?e.address.postalCode+" "+e.address.blockNumber+" "+e.address.streetName+" "+e.address.unitNumber:""})}),t}function a(e){var t=[{id:"",name:"All"}];return angular.forEach(e,function(e){t.push({id:e.id,name:e.organizationCode+" "+e.name})}),t}function l(e){var t={id:e.id,name:e.name,organizationCode:e.organizationCode,sapCode:e.sapCode,contactPerson:e.contactPerson,contactNumber:e.contactNumber,contractEndDate:new Date(e.contractEndDate),cutOffTimeForSameDayPickupAndDelivery:new Date(e.cutOffTimeForSameDayPickupAndDelivery),cutOffTimeForSameDayPickupAndNextDayDelivery:new Date(e.cutOffTimeForSameDayPickupAndNextDayDelivery),address:e.address,department:e.department,clientTypeId:e.department.id,users:e.applicationUsers,pricings:e.pricings};return t}var s=t.serviceUrl+"/api/customers/",c={getCustomerByCriteria:n,getCustomerById:o,saveCustomer:i,convertListCustomer:r,convertCustomer:l,convertListCustomerDropDownList:a};return c}angular.module("main.module").factory("customerService",e),e.$inject=["$http","systemSetting"]}(),function(){"use strict";function e(e,t){function n(t){var n=c+"?offset="+(t.currentPage-1)*t.itemPerPage;return n+="&limit="+t.itemPerPage,t.searchTerm&&(n+="&search="+t.searchTerm),t.department&&(n+="&departmentId="+t.department),t.organizationCode&&(n+="&organizationCode="+t.organizationCode),t.sortColumn&&(n+="&sortBy="+t.sortColumn,n+="&ascending="+t.sortAscending),e.get(n)}function o(t){return e.get(c+t)}function i(t){return e.put(c+t.id,t)}function r(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,name:e.firstName+" "+e.lastName,email:e.email,phoneNumber:e.phoneNumber,costCentre:e.costCentre,workAddress:e.workAddress?e.workAddress.postalCode+" "+e.workAddress.blockNumber+" "+e.workAddress.streetName+" "+e.workAddress.unitNumber:"",billingAddresses:s(e.billingAddresses,e),organizationCode:e.organizationCode})}),t}function a(t){return e.post(c+"userExists",{email:t})}function l(t){var n=t.lockoutEnabled?"activate/":"deactivate/";return e.post(c+n+t.id)}function s(e,t){var n,o="",i="";return e.length>u?(n=[e[0],e[1],e[2]],i='<a ng-click="vm.openDetailModal(user)"> ... and '+(e.length-u)+" more</a>"):n=e,angular.forEach(n,function(e){e&&(o+="<p>"+e.blockNumber+" "+e.streetName+" "+e.unitNumber+" "+e.postalCode+"</p>")}),o+i}var c=t.serviceUrl+"/api/users/",u=3,d={getClientUserByCriteria:n,getClientUserById:o,convertListUser:r,updateClientUser:i,checkEmailExist:a,activateOrDeactivate:l};return d}angular.module("main.module").factory("clientUserService",e),e.$inject=["$http","systemSetting"]}(),function(){"use strict";function e(e,t){function n(t){return e.get(o+t)}var o=t.serviceUrl+"/api/location/",i={getLocationByPostalCode:n};return i}angular.module("main.module").factory("locationService",e),e.$inject=["$http","systemSetting"]}(),function(){"use strict";function e(e,t,n,o,i,r,a,l,s){function c(n){var o=S+"?offset="+(n.currentPage-1)*n.itemPerPage;return o+="&limit="+n.itemPerPage,n.status&&(o+="&status="+n.status),""!==n.requestType&&(o+="&requestType="+n.requestType),n.dateFrom&&(o+="&fromCreatedDate="+t("date")(n.dateFrom,"yyyy-MM-dd")),n.dateTo&&(o+="&toCreatedDate="+t("date")(n.dateTo,"yyyy-MM-dd")),n.searchTerm&&(o+="&search="+n.searchTerm),n.customer&&(o+="&customerId="+n.customer),e.get(o)}function u(t){return e.get(S+t)}function d(t){return t.id?e.put(S+t.id,t):e.post(S,t)}function m(t,n){return e.post(S+t+"/approve",n)}function p(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,customer:e.organizationCode+" - "+e.customerName,createdDate:e.requestDate,collectionPoints:f(e.collectionPoints,e.id),deliveryPoints:f(e.deliveryPoints,e.id),frequency:g(e),status:v(e.jobStatus)})}),t}function g(e){var t="";for(var n in o)if(o[n].value===e.milkRunFrequency){t+=o[n].display;break}if(e.milkRunFrequency===o.weekly.value){var a="";angular.forEach(e.days,function(e){for(var t in i)if(i[t].value===e){a+=i[t].display+", ";break}}),a=a.substring(0,a.length-2),t+=" ("+a+")"}var l="";return angular.forEach(e.additionals,function(e){for(var t in r)if(r[t].value===e){l+=r[t].display+", ";break}}),l&&(l=l.substring(0,l.length-2),t+=", "+l),t}function f(e,t){var n,o="",i="";return e.length>R?(n=[e[0],e[1],e[2]],i='<a href="#milkrun/detail/'+t+'"> ... and '+(e.length-R)+" more<a/>"):n=e,angular.forEach(n,function(e){e.address&&(o+="<p>"+e.address.blockNumber+" "+e.address.streetName+" "+e.address.unitNumber+" "+e.address.postalCode+"</p>")}),o+i}function v(e){for(var t in l)if(l[t].value===e)return l[t].display;return""}function h(e){return{id:e.id,clientId:e.customerId,organizationCode:e.organizationCode,clientName:e.organizationCode+" "+e.customerName,requesterId:e.requesterId,requester:e.requesterName,costCenter:e.costCenter,requestDate:e.requestDate,milkRunType:e.milkRunType,milkRunFrequency:e.milkRunFrequency,days:e.days,additionals:e.additionals,collectionPoints:y(e.collectionPoints),deliveryPoints:y(e.deliveryPoints),remarks:e.remarks,totalPrice:e.totalPrice,jobStatus:e.jobStatus}}function y(e){return angular.forEach(e,function(e){angular.forEach(e.items,function(e){e.milkRunWeightId=e.milkRunWeight.id})}),e}function C(e){e.milkRunType==s.manyToOne&&P(e.deliveryPoints)&&k(e),e.milkRunType!=s.manyToOne&&P(e.collectionPoints)&&k(e)}function P(e){return!!(e&&e[0]&&e[0].items&&e[0].items.length>0)}function k(e){var t=e.collectionPoints;e.collectionPoints=e.deliveryPoints,e.deliveryPoints=t}function T(e){var t=[],n=e.split(/\r\n|\n/);if(n&&n.length>1)for(var o=1;o<n.length;o++)if(n[o]){var i=n[o].split(",");t.push({address:{postalCode:i[0],blockNumber:i[1],streetName:i[2],unitNumber:i[3]},name:i[4],contactNumber:i[5],items:[{milkRunWeightId:i[6],quantity:isNaN(i[7])?"":parseInt(i[7])}],isInValid:A(i)})}return t}function A(e){if(!e[0]||!e[1]||!e[2]||!e[3]||!e[4]||!e[5]||isNaN(e[7]))return!0;for(var t in a)if(e[6]==a[t].id)return!1;return!0}function M(e){if(!e||0===e.length)return!1;for(var t=0;t<e.length;t++)if(e[t].isInValid)return!1;return!0}function b(e,t){e.totalPrice=t.totalPrice;for(var n=0;n<e.collectionPoints.length;n++)e.collectionPoints[n].subTotalPrice=t.collectionPoints[n].subTotalPrice;for(var o=0;o<e.deliveryPoints.length;o++)e.deliveryPoints[o].subTotalPrice=t.deliveryPoints[o].subTotalPrice}var S=n.serviceUrl+"/api/milkrun/",R=3,D={getMilkRunByCriteria:c,getMilkRunById:u,saveMilkRun:d,convertListMilkRun:p,convertMilkRun:h,rejectApproveMilkRun:m,switchCollectionDeliveryPoint:C,getMilkRunPointsFromText:T,checkValidCollectionPoints:M,transferPricing:b};return D}angular.module("main.module").factory("milkrunService",e),e.$inject=["$http","$filter","systemSetting","milkRunFrequency","days","milkRunAdditionals","milkRunWeight","jobStatusType","milkRunTypes"]}(),function(){"use strict";function e(e){function t(t,o){var i=e.defer(),r=n(i,o);return r.readAsText(t),i.promise}function n(e,t){var n=new FileReader;return n.onload=o(n,e,t),n.onerror=i(n,e,t),n}function o(e,t,n){return function(){n.$apply(function(){t.resolve(e.result)})}}function i(e,t,n){return function(){n.$apply(function(){t.reject(e.result)})}}var r={readAsDataUrl:t};return r}angular.module("main.module").factory("fileReaderService",e),e.$inject=["$q"]}(),function(){"use strict";function e(e,t,n){function o(t){var o=i+"?offset="+(t.currentPage-1)*t.itemPerPage;return o+="&limit="+t.itemPerPage,t.dateFrom&&(o+="&dateFrom="+n("date")(t.dateFrom,"yyyy-MM-dd")),t.dateTo&&(o+="&dateTo="+n("date")(t.dateTo,"yyyy-MM-dd")),t.action&&(o+="&action="+t.action),t.role&&(o+="&role="+t.role),t.userSearch&&(o+="&userSearch="+t.userSearch),t.descriptionSearch&&(o+="&descriptionSearch="+t.descriptionSearch),t.sortColumn&&(o+="&sortBy="+t.sortColumn,o+="&ascending="+t.sortAscending),e.get(o)}var i=t.serviceUrl+"/api/log/",r={getLogByCriteria:o};return r}angular.module("main.module").factory("logService",e),e.$inject=["$http","systemSetting","$filter"]}(),function(){"use strict";function e(e,t,n){function o(){var n=t.serviceUrl+"/api/location/getFile";e({method:"GET",url:n,responseType:"arraybuffer"}).success(function(e,t,n){console.log(e),console.log(n),n=n();var o="master_location.csv",i=n["content-type"],r=document.createElement("a");try{var a=new Blob([e],{type:i}),l=window.URL.createObjectURL(a);r.setAttribute("href",l),r.setAttribute("download",o);var s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});r.dispatchEvent(s)}catch(e){console.log(e)}},function(e){console.log("fail to download"),console.log(e)})}function i(){var n=t.serviceUrl+"/api/location/lastUpdate";return e.get(n)}function r(e){console.log(e);var o=t.serviceUrl+"/api/location/import";return n.upload({url:o,data:{file:e}})}var a={downloadFile:o,uploadFile:r,lastUpdate:i};return a}angular.module("main.module").factory("allLocationsService",e),e.$inject=["$http","systemSetting","Upload"]}(),function(){"use strict";function e(e,t){function n(t){return e.post(a+"calculate/milkrun",t)}function o(t){return t.customerId=t.clientId,t.costCentre=t.costCenter,e.post(a+"calculate/adhoc",t)}function i(e,t){e.totalPrice=t.totalPrice,r(e.collectionPoints,t.collectionPoints),r(e.deliveryPoints,t.deliveryPoints)}function r(e,t){for(var n=0;n<e.length;n++)e[n].items=t[n].items}var a=t.serviceUrl+"/api/pricing/",l={calculateMilkRun:n,calculateAdhoc:o,transferAdhocPricing:i};return l}angular.module("main.module").factory("pricingService",e),e.$inject=["$http","systemSetting","$filter"]}(),function(){"use strict";function e(e,t,n,o,i,r,a){function l(t){var n=M+"?offset="+(t.currentPage-1)*t.itemPerPage;return n+="&limit="+t.itemPerPage,t.status&&(n+="&status="+t.status),t.dateFrom&&(n+="&fromCreatedDate="+a("date")(t.dateFrom,"yyyy-MM-dd")),t.dateTo&&(n+="&toCreatedDate="+a("date")(t.dateTo,"yyyy-MM-dd")),t.searchTerm&&(n+="&search="+t.searchTerm),t.customer&&(n+="&customerId="+t.customer),e.get(n)}function s(t){return y(t),t.id?e.put(M+t.id,t):e.post(M,t)}function c(t){return e.get(M+t)}function u(t){return e.post(M+"updateStatus",t)}function d(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,customer:e.customer.organizationCode+" - "+e.customer.name,createdDate:e.requestDate,collectionPoints:A(e.collectionPoints,e.id),deliveryPoints:A(e.deliveryPoints,e.id),requestType:k(e.serviceType),status:T(e.jobStatus,r)})}),t}function m(e){return{id:e.id,clientId:e.customerId,clientName:e.customer.organizationCode+" - "+e.customer.name,requesterId:e.requesterId,requester:e.requester.firstName+" - "+e.requester.lastName,costCenter:e.costCentre,requestDate:e.requestDate,serviceType:e.serviceType,jobStatus:e.jobStatus,remark:e.remark,jobType:e.jobType,collectionPoints:P(e.collectionPoints),deliveryPoints:P(e.deliveryPoints),additionalCharges:e.additionalCharges,totalPrice:e.totalPrice}}function p(e){var t=[],n=e.split(/\r\n|\n/);if(n&&n.length>1)for(var o=1;o<n.length;o++)if(n[o]){var i=n[o].split(",");t.push({address:{postalCode:i[0],blockNumber:i[1],streetName:i[2],unitNumber:i[3]},name:i[4],contactNumber:i[5],collectionDate:new Date(i[6]),collectionTime:new Date(i[6]),isInValid:g(i)})}return t}function g(e){return!(e[0]&&e[1]&&e[2]&&e[3]&&e[4]&&e[5]&&!isNaN(Date.parse(e[6])))}function f(e){e.jobType==n.manyToOne&&v(e.deliveryPoints)&&h(e),e.jobType!=n.manyToOne&&v(e.collectionPoints)&&h(e)}function v(e){return!!(e&&e[0]&&e[0].items&&e[0].items.length>0)}function h(e){var t=e.collectionPoints;e.collectionPoints=e.deliveryPoints,e.deliveryPoints=t}function y(e){e.customerId=e.clientId,e.costCentre=e.costCenter,C(e.collectionPoints),C(e.deliveryPoints)}function C(e){for(var t=0;t<e.length;t++){var n=new Date(e[t].collectionDate.getFullYear(),e[t].collectionDate.getMonth(),e[t].collectionDate.getDate(),e[t].collectionTime.getHours(),e[t].collectionTime.getMinutes());e[t].date=n}}function P(e){for(var t=0;t<e.length;t++)e[t].collectionDate=new Date(e[t].date),e[t].collectionTime=new Date(e[t].date),e[t].date=new Date(e[t].date);return e}function k(e){var t=T(e,o);return t||(t=T(e,i)),t}function T(e,t){for(var n in t)if(t[n].value===e)return t[n].display;return"N/A"}function A(e,t){var n,o="",i="";return e.length>b?(n=[e[0],e[1],e[2]],i='<a href="#adhoc/detail/'+t+'"> ... and '+(e.length-b)+" more<a/>"):n=e,angular.forEach(n,function(e){e.address&&(o+="<p>"+e.address.blockNumber+" "+e.address.streetName+" "+e.address.unitNumber+" "+e.address.postalCode+"</p>")}),o+i}var M=t.serviceUrl+"/api/jobs/",b=3,S={getAdhocPointsFromText:p,getAdhocByCriteria:l,saveAdhoc:s,getAdhocById:c,switchCollectionDeliveryPoint:f,convertAdhoc:m,convertListAdhoc:d,rejectApproveAdhoc:u};return S}angular.module("main.module").factory("adhocService",e),e.$inject=["$http","systemSetting","adhocTypes","adhocPSSServiceType","adhocHealthCareServiceType","jobStatus","$filter"]}(),function(){"use strict";function e(e,t,n,o,i,r){function a(t){var o=m+"milkrun?offset="+(t.currentPage-1)*t.itemPerPage;return o+="&limit="+t.itemPerPage,""!==t.requestType&&(o+="&requestType="+t.requestType),t.jobDate&&(o+="&jobDate="+n("date")(t.jobDate,"yyyy-MM-dd")),t.status&&(o+="&status="+t.status),t.dateFrom&&(o+="&fromCreatedDate="+n("date")(t.dateFrom,"yyyy-MM-dd")),t.dateTo&&(o+="&toCreatedDate="+n("date")(t.dateTo,"yyyy-MM-dd")),t.searchTerm&&(o+="&search="+t.searchTerm),t.customer&&(o+="&customerId="+t.customer),e.get(o)}function l(t){var o=m+"adhoc?offset="+(t.currentPage-1)*t.itemPerPage;return o+="&limit="+t.itemPerPage,""!==t.requestType&&(o+="&requestType="+t.requestType),t.jobDate&&(o+="&jobDate="+n("date")(t.jobDate,"yyyy-MM-dd")),t.status&&(o+="&status="+t.status),t.dateFrom&&(o+="&fromCreatedDate="+n("date")(t.dateFrom,"yyyy-MM-dd")),t.dateTo&&(o+="&toCreatedDate="+n("date")(t.dateTo,"yyyy-MM-dd")),t.searchTerm&&(o+="&search="+t.searchTerm),t.customer&&(o+="&customerId="+t.customer),e.get(o)}function s(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,barcode:e.barcode,customer:e.customer,createdDate:e.createdDate,jobDate:e.jobDate,status:d(e.status,o),collectionPoints:e.collectionPointAddress.blockNumber+" "+e.collectionPointAddress.streetName+" "+e.collectionPointAddress.unitNumber+" "+e.collectionPointAddress.postalCode,deliveryPoints:e.deliveryPointAddress.blockNumber+" "+e.deliveryPointAddress.streetName+" "+e.deliveryPointAddress.unitNumber+" "+e.deliveryPointAddress.postalCode,vendorName:e.vendorName})}),t}function c(e){var t=[];return angular.forEach(e,function(e){t.push({id:e.id,barcode:e.barcode,customer:e.customer,createdDate:e.createdDate,status:d(e.status,o),requestType:u(e.requestType),pickUpDate:e.pickUpDate,deliveryDate:e.deliveryDate,collectionPoint:e.collectionPointAddress.blockNumber+" "+e.collectionPointAddress.streetName+" "+e.collectionPointAddress.unitNumber+" "+e.collectionPointAddress.postalCode,deliveryPoint:e.deliveryPointAddress.blockNumber+" "+e.deliveryPointAddress.streetName+" "+e.deliveryPointAddress.unitNumber+" "+e.deliveryPointAddress.postalCode,vendorName:e.vendorName})}),t}function u(e){var t=d(e,i);return"N/A"===t&&(t=d(e,r)),t}function d(e,t){for(var n in t)if(t[n].value===e)return t[n].display;return"N/A"}var m=t.serviceUrl+"/api/tasks/",p={getMilkRunTaskByCriteria:a,getAdhocTaskByCriteria:l,convertListMilkRunTask:s,convertListAdhocTask:c};return p}angular.module("main.module").factory("taskService",e),e.$inject=["$http","systemSetting","$filter","taskStatus","adhocPSSServiceType","adhocHealthCareServiceType"]}(),function(){"use strict";function e(e){function t(){i.showChosenColumn&&(i.isContainColumn=o,i.translationTexts={checkAll:"Show All",dynamicButtonTextSuffix:"columns"},i.chosenColumnConfig={idProp:"name",displayProp:"display",showUncheckAll:!1},i.chosenColumnModel=[],angular.forEach(i.gridConfig.columns,function(e){i.chosenColumnModel.push({id:e.name})}))}function n(e){i.options.sortColumn===e?i.options.sortAscending=!i.options.sortAscending:(i.options.sortAscending=!0,i.options.sortColumn=e),i.actionRequest()}function o(e){var t=!1;return angular.forEach(i.chosenColumnModel,function(n){n.id===e&&(t=!0)}),t}var i=this;i.setItemPerPage=e,i.sort=n,t(),i.eventsChosenColumn={onItemDeselect:function(e){1===i.chosenColumnModel.length&&i.chosenColumnModel.push(e)}}}angular.module("main.module").directive("grid",function(){return{restrict:"E",scope:{gridConfig:"=",options:"=",data:"=",actionRequest:"&",isLoading:"=",showChosenColumn:"=?"},templateUrl:"app/directives/commonControls/grid/grid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["setItemPerPage"]}(),function(){"use strict";function e(e,t){function n(e){s.optionsGrid.sortColumn===e?s.optionsGrid.sortAscending=!s.optionsGrid.sortAscending:(s.optionsGrid.sortAscending=!0,s.optionsGrid.sortColumn=e),s.actionRequest()}function o(e){t.path(s.gridConfig.navigationDetail+e)}function i(e){console.log("select > "+e.id),a(e.id)}function r(e){console.log("deselect : "+e.id),l(e.id)}function a(e){switch(e){case 1:s.column1=!0;break;case 2:s.column2=!0;break;case 3:s.column3=!0;break;case 4:s.column4=!0;break;case 5:s.column5=!0;break;case 6:s.column6=!0;break;case 7:s.column7=!0;break;case 8:s.column8=!0}}function l(e){switch(e){case 1:s.column1=!1;break;case 2:s.column2=!1;break;case 3:s.column3=!1;break;case 4:s.column4=!1;break;case 5:s.column5=!1;break;case 6:s.column6=!1;break;case 7:s.column7=!1;break;case 8:s.column8=!1}}var s=this;s.setItemPerPage=e,s.optionsGrid={sortColumn:"",sortAscending:!0,itemPerPage:20,totalItems:0},s.sort=n,s.navigateToDetail=o,s.columnModel=[],s.columnsData=[{id:1,label:"Collection barcode"},{id:2,label:"Customer"},{id:3,label:"Created date"},{id:4,label:"Request type"},{id:5,label:"Request status"},{id:6,label:"Status"},{id:7,label:"Pick up point"},{id:8,label:"Delivery point"}],s.defaultText={buttonDefaultText:"Default"},s.column1=!0,s.column2=!0,s.column3=!0,s.column4=!0,s.column5=!0,s.column6=!0,s.column7=!0,s.column8=!0,s.columnModel=[{id:1},{id:2},{id:3},{id:4},{id:5},{id:6},{id:7},{id:8}],s.eventListeners={onItemSelect:i,onItemDeselect:r}}angular.module("main.module").directive("gridExt",function(){return{restrict:"E",scope:{gridConfig:"=",optionsGrid:"=",options:"=",data:"=",actionRequest:"&",isLoading:"="},templateUrl:"app/directives/commonControls/gridExt/gridExt.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["setItemPerPage","$location"]}(),function(){"use strict";function e(e,t){var n=this;n.data=t,n.ok=function(t){e.close(t)},n.cancel=function(){e.dismiss("cancel")}}angular.module("main.module").controller("ModalInstanceCtrl",e),e.$inject=["$uibModalInstance","data"]}(),function(){"use strict";function e(e,t,n,o,i){function r(){n.logout(),e.currentUser=null,t.path("/login")}var a=this;a.pageName=o,a.systemRole=i,a.logout=r}angular.module("main.module").directive("headerPage",function(){return{restrict:"E",templateUrl:"app/directives/header/header.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","$location","authService","pageName","systemRole"]}(),function(){"use strict";angular.module("main.module").directive("compareTo",function(){return{restrict:"A",require:"ngModel",scope:{compareTo:"=compareTo"},link:function(e,t,n,o){t.bind("keyup",function(){e.$apply(function(){var n=t.val(),i=e.compareTo,r=n&&n===i;o.$setValidity("compareTo",r)})})}}})}(),function(){"use strict";function e(e){function t(){n.isOpen=!1,n.minDate&&e.$watch("vm.minDate",function(e){n.datepickerOptions={minDate:e}})}var n=this;t(),n.openCalendar=function(e){e.preventDefault(),e.stopPropagation(),n.isOpen=!0}}angular.module("main.module").directive("customDatePicker",function(){return{restrict:"E",scope:{ngModel:"=",placeHolder:"@?",minDate:"=?"},templateUrl:"app/directives/commonControls/datePicker/datePicker.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$scope"]}(),function(){"use strict";function e(){var e=this;e.timepickerOptions={showMeridian:!1},e.isOpen=!1,e.openCalendar=function(t){t.preventDefault(),t.stopPropagation(),e.isOpen=!0}}angular.module("main.module").directive("customTimePicker",function(){return{restrict:"E",scope:{ngModel:"="},templateUrl:"app/directives/commonControls/timePicker/timePicker.html",controller:e,controllerAs:"vm",bindToController:!0}})}(),function(){"use strict";function e(e){return{restrict:"A",link:function(t,n,o){var i=e(o.fileModel),r=i.assign,a=t.$eval(o.customOnChange);n.bind("change",function(){r(t,n[0].files[0]),a()})}}}angular.module("main.module").directive("fileModel",e),e.$inject=["$parse"]}(),function(){"use strict";function e(e,t,n){function o(){s.userDetail.billingAddresses.push({postalCode:"",blockNumber:"",streetName:"",unitNumber:""})}function i(e){s.userDetail.billingAddresses.splice(e,1)}function r(){e.checkEmailExist(s.userDetail.email).then(function(e){s.emailExist=!0},function(e){s.emailExist=!1})}function a(){var e=s.userDetail.lockoutEnabled?"Are you sure you want to activate this user?":"Are you sure you want to deactivate this user?";t.createWarningPopup(e,"Warning",l)}function l(){e.activateOrDeactivate(s.userDetail).then(function(e){var t=s.userDetail.lockoutEnabled?"The user has been activated successfully.":"The user has been deactivated successfully.";s.userDetail.lockoutEnabled=!s.userDetail.lockoutEnabled,n.success(t)})}var s=this;s.addBillingAddress=o,s.deleteBillAddress=i,s.checkEmailExist=r,s.activateOrDeactivate=a}angular.module("main.module").directive("userClientDetail",function(){return{restrict:"E",scope:{userDetail:"=",onCreateOrUpdate:"&",onCancel:"&"},templateUrl:"app/directives/userClient/userClientDetail.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["clientUserService","modalService","toastr"]}(),function(){"use strict";function e(e){function t(){i()}function n(t){return e.getLocationByPostalCode(t).then(function(e){return[{postalCode:e.data.postalCode,blockNumber:e.data.buildingNumber,streetName:e.data.streetName}]})}function o(e){r.ngModel.postalCode=e.postalCode,r.ngModel.blockNumber=e.blockNumber,r.ngModel.streetName=e.streetName}function i(){r.ngModel.postalCode&&r.ngModel.blockNumber&&r.ngModel.streetName&&r.ngModel.unitNumber||r.isDelete?r.isValid=!0:r.isValid=!1}var r=this;r.searchAddressByPostalCode=n,r.onSelect=o,r.checkValidAddress=i,t()}angular.module("main.module").directive("userAddress",function(){return{restrict:"E",scope:{ngModel:"=",isSearchable:"=",isDelete:"=?",isShowFullWidth:"=",onDelete:"&?",isValid:"=?",isShowWarning:"=?",warningMessage:"@?"},templateUrl:"app/directives/userClient/userAddress.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["locationService"]}(),function(){"use strict";function e(e,t,n,o,i,r,a){function l(){g.ngModel.requestDate=g.ngModel.requestDate||new Date,g.ngModel.days=g.ngModel.days||[],g.ngModel.additionals=g.ngModel.additionals||[],g.ngModel.frequency!==n.weekly&&(g.ngModel.days=[]),m()}function s(e){var t=g.ngModel.days.indexOf(e);t>-1?g.ngModel.days.splice(t,1):g.ngModel.days.push(e),g.weeklyInvalid=0===g.ngModel.days.length}function c(e){var t=g.ngModel.additionals.indexOf(e);t>-1?g.ngModel.additionals.splice(t,1):g.ngModel.additionals.push(e),m()}function u(){g.ngModel.milkRunFrequency==n.weekly.value&&0===g.ngModel.days.length?g.weeklyInvalid=!0:(g.weeklyInvalid=!1,g.ngModel.days=[])}function d(){r.switchCollectionDeliveryPoint(g.ngModel)}function m(){g.saturdaysChecked=g.ngModel.additionals.indexOf(g.milkRunAdditionals.saturdays.value)>-1,g.sundaysChecked=g.ngModel.additionals.indexOf(g.milkRunAdditionals.sundays.value)>-1,g.afterOfficeHoursChecked=g.ngModel.additionals.indexOf(g.milkRunAdditionals.afterOfficeHours.value)>-1,g.publicHolidaysChecked=g.ngModel.additionals.indexOf(g.milkRunAdditionals.publicHolidays.value)>-1}function p(){g.currentProgress=t.collectionPoint}var g=this;g.systemRole=a,g.milkRunTypes=e,g.milkRunFrequency=n,g.days=o,g.milkRunAdditionals=i,g.next=p,g.changeDay=s,g.changeAdditional=c,g.changeFrequency=u,g.changeMilkRunType=d,l()}angular.module("milkRun.module").directive("choseMilkRunType",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/milkRun/step/choseMilkrunType.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["milkRunTypes","milkRunProgress","milkRunFrequency","days","milkRunAdditionals","milkrunService","systemRole"]}(),function(){"use strict";function e(e,t){function n(){i.currentProgress=e.deliveryPoint}function o(){i.currentProgress=e.chosenMilkRunType}var i=this;i.milkRunTypes=t,i.next=n,i.back=o,i.ngModel.collectionPoints=i.ngModel.collectionPoints||[]}angular.module("milkRun.module").directive("collectionPoint",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/milkRun/step/collectionPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["milkRunProgress","milkRunTypes"]}(),function(){"use strict";function e(e,t,n,o){function i(){l.apllyItemTemplate=!1,l.ngModel.deliveryPoints=l.ngModel.deliveryPoints||[],l.ngModel.milkRunType==n.oneToOne&&l.ngModel.deliveryPoints.length>1&&(l.ngModel.deliveryPoints=[l.ngModel.deliveryPoints[0]])}function r(){e.currentUser.role===o.Admin?l.currentProgress=t.remark:l.currentProgress=t.confirmOrder}function a(){l.currentProgress=t.collectionPoint}var l=this;l.milkRunTypes=n,l.next=r,l.back=a,i()}angular.module("milkRun.module").directive("deliveryPoint",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/milkRun/step/deliveryPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","milkRunProgress","milkRunTypes","systemRole"]}(),function(){"use strict";function e(e){function t(){o.currentProgress=e.confirmOrder}function n(){o.currentProgress=e.deliveryPoint}var o=this;o.next=t,o.back=n}angular.module("milkRun.module").directive("remark",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/milkRun/step/remark.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["milkRunProgress"]}(),function(){"use strict";function e(e,t,n,o,i,r,a,l,s,c,u){function d(){y.ngModel&&e.currentUser.department===u.PSS.name&&(y.isLoading=!0,c.calculateMilkRun(y.ngModel).then(function(e){i.transferPricing(y.ngModel,e.data),y.isLoading=!1}).catch(function(e){l.warning("There's no pricing for calculation!"),y.isLoading=!1}))}function m(){y.isLoading=!0,i.saveMilkRun(y.ngModel).then(function(e){y.isLoading=!1;var n=y.ngModel.id?"The Fixed Run has been updated successfully.":"The Fixed Run has been created successfully.";l.success(n),t.path("/milkruns")})}function p(e){var t={confirm:e?f:g};y.approveRejectData={isApprove:e,remark:""},a.createPopup({templateUrl:"app/directives/milkRun/step/approveRejectModal.html",size:"lg",data:y.approveRejectData},t)}function g(){y.isLoading=!0,i.rejectApproveMilkRun(y.ngModel.id,{status:0,remark:y.approveRejectData.remark}).then(function(e){y.isLoading=!1,l.success("The Fixed Run has been rejected successfully."),y.ngModel.jobStatus=s.rejected.value})}function f(){y.isLoading=!0,i.rejectApproveMilkRun(y.ngModel.id,{status:1,remark:y.approveRejectData.remark}).then(function(e){y.isLoading=!1,l.success("The Fixed Run has been approved successfully."),y.ngModel.jobStatus=s.accepted.value})}function v(){e.currentUser.role===r.Admin?y.currentProgress=n.remark:y.currentProgress=n.deliveryPoint}function h(){y.viewMode=!1,y.currentProgress=n.chosenMilkRunType}var y=this;y.departments=u,y.milkRunTypes=o,y.systemRole=r,y.jobStatusType=s,y.back=v,y.saveMilkRun=m,y.edit=h,y.approveRejectMilkRun=p,d()}angular.module("milkRun.module").directive("confirmOrder",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"=",viewMode:"=",isLoading:"="},templateUrl:"app/directives/milkRun/step/confirmOrder.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","$location","milkRunProgress","milkRunTypes","milkrunService","systemRole","modalService","toastr","jobStatusType","pricingService","departments"]}(),function(){"use strict";function e(e,t,n){function o(t){for(var n in e)if(e[n].id==t)return e[n].text;return""}function i(e,t){r.ngModel.splice(t,1),r.validatePoint(),e.stopPropagation()}var r=this;r.milkRunTypes=t,r.departments=n,r.getMilkRunText=o,r.removePoint=i}angular.module("milkRun.module").directive("listPoint",function(){return{restrict:"E",scope:{ngModel:"=",allowRemove:"=",milkRunType:"=?",onDetailClick:"&?",validatePoint:"&?"},templateUrl:"app/directives/milkRun/listPoint/listPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["milkRunWeight","milkRunTypes","departments"]}(),function(){"use strict";function e(){var e=this;e.form=e.form||{}}angular.module("milkRun.module").directive("milkrunContact",function(){return{restrict:"E",scope:{ngModel:"=",form:"=?"},templateUrl:"app/directives/milkRun/contact/milkrunContact.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(e){var t=this;t.milkRunWeight=e,t.ngModel=t.ngModel||[{}],t.form=t.form||{}}angular.module("milkRun.module").directive("milkrunItem",function(){return{restrict:"E",scope:{ngModel:"=",form:"=?"
},templateUrl:"app/directives/milkRun/milkrunItem/milkrunItem.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["milkRunWeight"]}(),function(){"use strict";function e(e,t,n,o,i,r){function a(){p.isValid=i.checkValidCollectionPoints(p.ngModel)}function l(){p.dataModal={point:{items:angular.copy(p.templateItem)||[]},index:p.ngModel.length+1,isOneToMany:p.milkRunType==t.oneToMany,applyTemplateItem:!1,isAddNew:!0},u()}function s(){p.dataModal.applyTemplateItem&&(p.templateItem=p.dataModal.point.items),p.dataModal.isAddNew?p.ngModel.push(p.dataModal.point):(p.dataModal.point.isInValid=!1,p.ngModel[p.dataModal.index-1]=p.dataModal.point),m()}function c(e,n){p.dataModal={point:angular.copy(e),index:n,isOneToMany:p.milkRunType==t.oneToMany,applyTemplateItem:!1},u()}function u(){var e={updatePoint:s};n.createPopup({templateUrl:"app/directives/milkRun/point/newPointModal.html",size:"lg",data:p.dataModal},e)}function d(){r(function(){document.getElementById("uploadFile").click()})}function m(){p.isValid=i.checkValidCollectionPoints(p.ngModel)}var p=this;p.ngModel=p.ngModel||[],p.milkRunTypes=t,p.addNewPoint=l,p.editPoint=c,p.openFile=d,p.validatePoint=m,a(),p.uploadFile=function(){p.csvFile&&o.readAsDataUrl(p.csvFile,e).then(function(e){var t=i.getMilkRunPointsFromText(e);p.ngModel=p.ngModel.concat(t),m()})}}angular.module("milkRun.module").directive("manyPoint",function(){return{restrict:"E",scope:{ngModel:"=",milkRunType:"=",isValid:"="},templateUrl:"app/directives/milkRun/point/manyPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$scope","milkRunTypes","modalService","fileReaderService","milkrunService","$timeout"]}(),function(){"use strict";function e(){var e=this;e.ngModel=e.ngModel||[]}angular.module("milkRun.module").directive("onePoint",function(){return{restrict:"E",scope:{ngModel:"=",contactForm:"=?",milkRunItemForm:"=?"},templateUrl:"app/directives/milkRun/point/onePoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(){var e=this;e.ngModel=e.ngModel||[]}angular.module("milkRun.module").directive("pointDetail",function(){return{restrict:"E",scope:{ngModel:"=",milkRunType:"="},templateUrl:"app/directives/milkRun/point/pointDetail.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(){}angular.module("main.module").directive("milkrunPricingRow",function(){return{restrict:"E",scope:{ngModel:"=",label:"@",isValidate:"="},templateUrl:"app/directives/advanceMilkRunPricing/milkRunPricingRow.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(e){function t(){r.ngModel&&0!==r.ngModel.length?o():n()}function n(){r.ngModel=[];for(var t in e)r.ngModel.push({category:e[t].value,label:e[t].display})}function o(){angular.forEach(r.ngModel,function(e){e.label=i(e.category)})}function i(t){for(var n in e)if(e[n].value===t)return e[n].display}var r=this;t()}angular.module("main.module").directive("milkrunPricingTab",function(){return{restrict:"E",scope:{ngModel:"=",isValidate:"="},templateUrl:"app/directives/advanceMilkRunPricing/milkRunPricingTab.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["deliveryPointCategory"]}(),function(){"use strict";function e(e,t){function n(){u.ngModel.weightCategories&&0!==u.ngModel.weightCategories?i():o()}function o(){u.ngModel.weightCategories=[];for(var t in e)u.ngModel.weightCategories.push({weightCategoryId:e[t].value,label:e[t].display})}function i(){angular.forEach(u.ngModel.weightCategories,function(e){e.label=r(e.weightCategoryId)})}function r(t){for(var n in e)if(e[n].value===t)return e[n].display}function a(e){u.activateMilkRunTab=e}function l(){u.isValidate=!0;for(var e=!0,t=0;t<u.ngModel.weightCategories.length;t++){var n=s(u.ngModel.weightCategories[t].deliveryPointCategories);u.ngModel.weightCategories[t].isValid=n,e=!!n&&e}e&&u.setPrice()}function s(e){if(!e)return!1;for(var t=0;t<e.length;t++)if(!c(e[t]))return!1;return!0}function c(e){return!!(e.twiceDaily&&e.daily&&e.thricePerWeek&&e.weekly&&e.projectRun)}var u=this;u.departments=t,u.activateMilkRunTab=e.milkrunUptoFiveKg.value,u.changeMilkRunTab=a,u.setPricing=l,n()}angular.module("main.module").directive("milkrunPricingAdvance",function(){return{restrict:"E",scope:{ngModel:"=?",cancel:"&",setPrice:"&"},templateUrl:"app/directives/advanceMilkRunPricing/milkRunPricingAdvance.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["milkRunWeightCategory","departments"]}(),function(){"use strict";function e(e,t,n,o){t.bind("change",function(t){var n=t.target.files,i=n[0];o.$setViewValue(i),e.$apply()})}angular.module("main.module").directive("fileUpload",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){console.log(event),t.bind("change",function(t){var n=t.target.files,i=n[0];o.$setViewValue(i),e.$apply()})}}}),e.$inject=[]}(),function(){"use strict";function e(e,t){function n(){i(),o(),r()}function o(){if(!a.ngModel.deliveryTimings||0===a.ngModel.deliveryTimings.length){a.ngModel.deliveryTimings=[];for(var e in t)a.ngModel.deliveryTimings.push({deliveryTimingId:t[e].value,label:t[e].display,rate:3})}}function i(){if(!a.ngModel.label)for(var t in e)if(e[t].value===a.ngModel.weightCategoryId)return void(a.ngModel.label=e[t].display)}function r(){a.rowLabels=[];for(var e in t)a.rowLabels.push(t[e].display)}var a=this;n()}angular.module("main.module").directive("healthCarePricingRow",function(){return{restrict:"E",scope:{ngModel:"=",isValidate:"="},templateUrl:"app/directives/healthCarePricing/healthCarePricingRow.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["healthCareWeightCategory","healthCareDeliveryTiming"]}(),function(){"use strict";function e(e){function t(){n()}function n(){if(!r.ngModel.weightCategories||0===r.ngModel.weightCategories.length){r.ngModel.weightCategories=[];for(var t in e)r.ngModel.weightCategories.push({weightCategoryId:e[t].value,label:e[t].display})}}function o(){r.isValidate=!0;for(var e=0;e<r.ngModel.weightCategories.length;e++)if(!i(r.ngModel.weightCategories[e]))return!1;r.setPrice()}function i(e){for(var t=0;t<e.deliveryTimings.length;t++)if(!e.deliveryTimings[t].rate||e.deliveryTimings[t].rate<=0)return!1;return!0}var r=this;r.validateAndSave=o,t()}angular.module("main.module").directive("healthCarePricing",function(){return{restrict:"E",scope:{ngModel:"=",cancel:"&",setPrice:"&"},templateUrl:"app/directives/healthCarePricing/healthCarePricing.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["healthCareWeightCategory"]}(),function(){"use strict";function e(e,t,n,o,i,r,a){function l(){s()}function s(){var t=e.currentUser.department===i.PSS.name?n:o;d.serviceTypes=[];for(var r in t)d.serviceTypes.push({value:t[r].value,display:t[r].display})}function c(){a.switchCollectionDeliveryPoint(d.ngModel)}function u(){d.currentProgress=t.collectionPoint}var d=this;d.departments=i,d.adhocTypes=r,d.next=u,d.changeAdhocType=c,l()}angular.module("adhoc.module").directive("choseAdhocType",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/adhoc/step/choseAdhocType.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","adhocProgress","adhocPSSServiceType","adhocHealthCareServiceType","departments","adhocTypes","adhocService"]}(),function(){"use strict";function e(e,t){function n(){i.currentProgress=e.deliveryPoint}function o(){i.currentProgress=e.chosenAdhocType}var i=this;i.adhocTypes=t,i.next=n,i.back=o,i.ngModel.collectionPoints=i.ngModel.collectionPoints||[]}angular.module("adhoc.module").directive("adhocCollectionPoint",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/adhoc/step/collectionPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["adhocProgress","adhocTypes"]}(),function(){"use strict";function e(e,t,n,o){function i(){l.apllyItemTemplate=!1,l.ngModel.deliveryPoints=l.ngModel.deliveryPoints||[],l.ngModel.jobType==n.oneToOne&&l.ngModel.deliveryPoints.length>1&&(l.ngModel.deliveryPoints=[l.ngModel.deliveryPoints[0]])}function r(){l.currentProgress=t.addItem}function a(){l.currentProgress=t.collectionPoint}var l=this;l.adhocTypes=n,l.next=r,l.back=a,i()}angular.module("adhoc.module").directive("adhocDeliveryPoint",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/adhoc/step/deliveryPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","adhocProgress","adhocTypes","systemRole"]}(),function(){"use strict";function e(e,t,n,o){function i(){r()}function r(){for(var e=s.ngModel.jobType==n.manyToOne?s.ngModel.collectionPoints:s.ngModel.deliveryPoints,t=0;t<e.length;t++)if(!e[t].items||0===e[t].items.length)return void(s.isValid=!1);s.isValid=!0}function a(){e.currentUser.role===o.Admin?s.currentProgress=t.remark:s.currentProgress=t.confirmOrder}function l(){s.currentProgress=t.deliveryPoint}var s=this;s.adhocTypes=n,s.next=a,s.back=l,s.validate=r,i()}angular.module("adhoc.module").directive("addItems",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/adhoc/step/addItems.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","adhocProgress","adhocTypes","systemRole"]}(),function(){"use strict";function e(e){function t(){o.currentProgress=e.confirmOrder}function n(){o.currentProgress=e.addItem}var o=this;o.next=t,o.back=n}angular.module("adhoc.module").directive("adhocRemark",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"="},templateUrl:"app/directives/adhoc/step/remark.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["adhocProgress"]}(),function(){"use strict";function e(e,t,n,o,i,r,a,l,s,c,u){function d(){y.ngModel&&e.currentUser.department===u.PSS.name&&(y.isLoading=!0,c.calculateAdhoc(y.ngModel).then(function(e){c.transferAdhocPricing(y.ngModel,e.data),y.isLoading=!1}).catch(function(e){l.warning("There's no pricing for calculation!"),y.isLoading=!1}))}function m(){y.isLoading=!0,i.saveAdhoc(y.ngModel).then(function(e){y.isLoading=!1;var n=y.ngModel.id?"The Ad Hoc has been updated successfully.":"The Ad Hoc has been created successfully.";l.success(n),t.path("/adhocs")})}function p(e){var t={confirm:e?f:g};y.approveRejectData={isApprove:e,remark:""},a.createPopup({templateUrl:"app/directives/milkRun/step/approveRejectModal.html",size:"lg",data:y.approveRejectData},t)}function g(){y.isLoading=!0,i.rejectApproveAdhoc({id:y.ngModel.id,jobStatus:s.rejected.value,remark:y.approveRejectData.remark}).then(function(e){y.isLoading=!1,l.success("The Ad Hoc has been rejected successfully."),y.ngModel.jobStatus=s.rejected.value})}function f(){y.isLoading=!0,i.rejectApproveAdhoc({id:y.ngModel.id,jobStatus:s.accepted.value,remark:y.approveRejectData.remark}).then(function(e){y.isLoading=!1,l.success("The Ad Hoc has been approved successfully."),y.ngModel.jobStatus=s.accepted.value})}function v(){e.currentUser.role===r.Admin?y.currentProgress=n.remark:y.currentProgress=n.addItem}function h(){y.viewMode=!1,y.currentProgress=n.chosenAdhocType}var y=this;y.departments=u,y.adhocTypes=o,y.systemRole=r,y.jobStatusType=s,y.back=v,y.saveAdhoc=m,y.edit=h,y.approveRejectMilkRun=p,d()}angular.module("adhoc.module").directive("adhocConfirmOrder",function(){return{restrict:"E",scope:{ngModel:"=",currentProgress:"=",viewMode:"=",isLoading:"="},templateUrl:"app/directives/adhoc/step/confirmOrder.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","$location","adhocProgress","adhocTypes","adhocService","systemRole","modalService","toastr","jobStatusType","pricingService","departments"]}(),function(){"use strict";function e(e,t,n,o){function i(){d.ngModel.requestDate=d.ngModel.requestDate||new Date,r()}function r(){d.ngModel.clientId&&e.currentUser.role===t.Admin&&n.getClientUserByCriteria({organizationCode:d.ngModel.organizationCode}).then(function(e){d.users=e.data.users,c()}),e.currentUser.role===t.User&&n.getClientUserById(e.currentUser.id).then(function(t){d.ngModel.clientName=t.data.organizationCode+" - "+t.data.customerName,d.ngModel.clientId=e.currentUser.customerId,d.users=[t.data],d.ngModel.requester=t.data.firstName+" "+t.data.lastName,d.ngModel.requesterId=e.currentUser.id,d.costCenters=t.data.costCentre.split(",")})}function a(t){return o.getCustomerByCriteria({currentPage:1,itemPerPage:20,searchTerm:t},e.currentUser.department).then(function(e){return e.data.customers})}function l(e){d.ngModel.clientId=e.id,d.ngModel.clientName=e.organizationCode+" - "+e.name,n.getClientUserByCriteria({organizationCode:e.organizationCode}).then(function(e){d.users=e.data.users})}function s(){d.ngModel.requesterId&&d.users?c():d.ngModel.costCenter=""}function c(){var e=d.users.filter(function(e){return e.id===d.ngModel.requesterId});e&&e[0]&&e[0].costCentre&&(d.ngModel.requester=e[0].firstName+" "+e[0].lastName,d.costCenters=e[0].costCentre.split(","))}function u(){d.users=[],d.costCenters=[],d.ngModel.requesterId="",d.ngModel.costCenter=""}var d=this;d.systemRole=t,d.searchClient=a,d.onSelectClient=l,d.changeUser=s,d.clientChange=u,i()}angular.module("adhoc.module").directive("jobChoseCustomer",function(){return{restrict:"E",scope:{ngModel:"="},templateUrl:"app/directives/jobCommon/jobChoseCustomer.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","systemRole","clientUserService","customerService"]}(),function(){"use strict";function e(e,t){function n(e,t){o.ngModel.splice(t,1),o.validatePoint(),e.stopPropagation()}var o=this;o.adhocTypes=e,o.departments=t,o.removePoint=n}angular.module("adhoc.module").directive("adhocListPoint",function(){return{restrict:"E",scope:{ngModel:"=",allowRemove:"=",jobType:"=?",onDetailClick:"&?",validatePoint:"&?"},templateUrl:"app/directives/adhoc/listPoint/listPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["adhocTypes","departments"]}(),function(){"use strict";function e(e,t,n,o,i,r,a){function l(){g.isValid=i.checkValidCollectionPoints(g.ngModel)}function s(){g.dataModal={point:{items:angular.copy(g.templateItem)||[]},index:g.ngModel.length+1,isOneToMany:g.jobType==t.oneToMany,applyTemplateItem:!1,isAddNew:!0},d()}function c(){g.dataModal.applyTemplateItem&&(g.templateItem=g.dataModal.point.items),g.dataModal.isAddNew?g.ngModel.push(g.dataModal.point):(g.dataModal.point.isInValid=!1,g.ngModel[g.dataModal.index-1]=g.dataModal.point),p()}function u(e,n){g.dataModal={point:angular.copy(e),index:n,isOneToMany:g.jobType==t.oneToMany,applyTemplateItem:!1},d()}function d(){var e={updatePoint:c};n.createPopup({templateUrl:"app/directives/adhoc/point/newPointModal.html",size:"lg",data:g.dataModal},e)}function m(){r(function(){document.getElementById("uploadFile").click()})}function p(){g.isValid=i.checkValidCollectionPoints(g.ngModel)}var g=this;g.ngModel=g.ngModel||[],g.adhocTypes=t,g.addNewPoint=s,g.editPoint=u,g.openFile=m,g.validatePoint=p,l(),g.uploadFile=function(){g.csvFile&&o.readAsDataUrl(g.csvFile,e).then(function(e){var t=a.getAdhocPointsFromText(e);g.ngModel=g.ngModel.concat(t),p()})}}angular.module("adhoc.module").directive("adhocManyPoint",function(){return{restrict:"E",scope:{ngModel:"=",jobType:"=",isValid:"="},templateUrl:"app/directives/adhoc/point/manyPoint.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$scope","adhocTypes","modalService","fileReaderService","milkrunService","$timeout","adhocService"]}(),function(){"use strict";function e(e){var t=this;t.adhocTypes=e,t.ngModel=t.ngModel||[]}angular.module("adhoc.module").directive("adhocPointDetail",function(){return{restrict:"E",scope:{ngModel:"=",jobType:"="},templateUrl:"app/directives/adhoc/point/pointDetail.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["adhocTypes"]}(),function(){"use strict";function e(e,t,n,o,i,r,a){function l(){m.ngModel.items=m.ngModel.items||[]}function s(){m.dataModal={item:{},isAddNew:!0},c()}function c(){m.dataModal.uoms=e.currentUser.department===r.PSS.name?o:i,m.dataModal.isHealthCare=e.currentUser.department===r.Healthcare.name,m.dataModal.itemsHealthCare=a;var t={updateItem:u};n.createPopup({templateUrl:"app/directives/adhoc/pointItem/newItemModal.html",size:"lg",data:m.dataModal},t)}function u(){m.dataModal.isAddNew?m.ngModel.items.push(m.dataModal.item):m.ngModel.items[m.dataModal.index]=m.dataModal.item,m.validate()}function d(e,t){m.dataModal={item:angular.copy(e),index:t,isAddNew:!1},c()}var m=this;m.adhocTypes=t,m.addNewItem=s,m.editItem=d,l()}angular.module("adhoc.module").directive("pointItem",function(){return{restrict:"E",scope:{ngModel:"=",index:"@",jobType:"@",validate:"&"},templateUrl:"app/directives/adhoc/pointItem/pointItem.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","adhocTypes","modalService","uomPSS","uomHealthCare","departments","itemsHealthCare"]}(),function(){"use strict";function e(e,t){function n(e,t){o.ngModel.splice(t,1),o.validate(),e.stopPropagation()}var o=this;o.adhocTypes=e,o.departments=t,o.removeItem=n}angular.module("adhoc.module").directive("listItem",function(){return{restrict:"E",scope:{ngModel:"=",allowRemove:"=",jobType:"=?",onDetailClick:"&?",validate:"&?"},templateUrl:"app/directives/adhoc/pointItem/listItem.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["adhocTypes","departments"]}(),function(){"use strict";function e(){var e=this;e.form=e.form||{}}angular.module("adhoc.module").directive("adhocContact",function(){return{restrict:"E",scope:{ngModel:"=",form:"=?"},templateUrl:"app/directives/adhoc/contact/adhocContact.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(){function e(){if(n.isValidate=!0,!(!n.ngModel.additionalNonWorkingDay||n.ngModel.additionalNonWorkingDay<=0||!n.ngModel.additionalAfterOfficeHr||n.ngModel.additionalAfterOfficeHr<=0)){for(var e=0;e<n.ngModel.weightCategories.length;e++)if(!t(n.ngModel.weightCategories[e]))return;n.setPrice()}}function t(e){for(var t=0;t<e.deliveryTimings.length;t++)if(!e.deliveryTimings[t].rate||e.deliveryTimings[t].rate<=0)return!1;return!0}var n=this;n.validateAndSave=e}angular.module("main.module").directive("adhocPssPricing",function(){return{restrict:"E",scope:{ngModel:"=",cancel:"&",setPrice:"&"},templateUrl:"app/directives/adhocPSSPricing/adhocPSSPricing.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(){}angular.module("main.module").directive("adhocPssPricingRow",function(){return{restrict:"E",scope:{ngModel:"=",isValidate:"="},templateUrl:"app/directives/adhocPSSPricing/adhocPSSPricingRow.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(e){function t(e){var t=!1;return angular.forEach(o.chosenColumnModel,function(n){n.id===e&&(t=!0)}),t}function n(t){e.path("/milkrun/detail/"+t)}var o=this;o.isContainColumn=t,o.goToDetailPage=n}angular.module("milkRun.module").directive("milkrunJobGrid",function(){return{restrict:"E",scope:{ngModel:"=",chosenColumnModel:"="},templateUrl:"app/directives/milkRun/jobs/milkRunJobGrid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$location"]}(),function(){"use strict";function e(){function e(){r.isCheckAll?o():r.listAssignTransaction=[]}function t(e){r.isCheckAll=!1;for(var t=!1,n=0;n<r.listAssignTransaction.length;n++)if(r.listAssignTransaction[n]==e)return t=!0,void r.listAssignTransaction.splice(n,1);r.listAssignTransaction.push(e)}function n(e){for(var t=0;t<r.listAssignTransaction.length;t++)if(r.listAssignTransaction[t]==e)return!0;return!1}function o(){r.listAssignTransaction=[],angular.forEach(r.ngModel,function(e){r.listAssignTransaction.push(e.id)})}function i(e){var t=!1;return angular.forEach(r.chosenColumnModel,function(n){n.id===e&&(t=!0)}),t}var r=this;r.isContainColumn=i,r.listAssignTransaction=[],r.checkAllChange=e,r.bindingCheck=n,r.onCheckTransaction=t}angular.module("milkRun.module").directive("milkrunTransactionGrid",function(){return{restrict:"E",scope:{ngModel:"=",chosenColumnModel:"="},templateUrl:"app/directives/milkRun/jobs/milkRunTransactionGrid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}(),function(){"use strict";function e(e,t,n,o,i,r,a,l,s,c){function u(){e.currentUser.role!==n.User&&d(),m(),g.statuses=p(g.isTransaction?i:o)}function d(){t.getCustomerByCriteria({currentPage:1,itemPerPage:1e3}).then(function(e){g.customers=t.convertListCustomerDropDownList(e.data.customers)})}function m(){g.gridType===r.milkRunJob||g.gridType===r.milkRunTransaction?g.requestTypes=p(a):e.currentUser.department===l.PSS.name?g.requestTypes=p(s):g.requestTypes=p(c)}function p(e){var t=[{value:"",text:"All"}];for(var n in e)t.push({value:e[n].value,text:e[n].display});return t}var g=this;g.systemRole=n,g.jobGridType=r,u()}angular.module("main.module").directive("jobFilter",function(){return{restrict:"E",scope:{options:"=",actionRequest:"&",isTransaction:"@",gridType:"@"},templateUrl:"app/directives/jobCommon/jobFilter.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","customerService","systemRole","jobStatus","taskStatus","jobGridType","milkRunFrequency","departments","adhocPSSServiceType","adhocHealthCareServiceType"]}(),function(){"use strict";function e(e,t){function n(){i.translationTexts={checkAll:"Show All",dynamicButtonTextSuffix:"columns"},i.chosenColumnConfig={idProp:"name",displayProp:"display",showUncheckAll:!1},i.chosenColumnModel=[],angular.forEach(i.gridConfig.columns,function(e){i.chosenColumnModel.push({id:e.name})})}function o(){var e=window.location.hostname,t='<link rel="stylesheet" type="text/css" href="../bower_components/bootstrap/dist/css/bootstrap.css"><link href="./css/custom.css" rel="stylesheet" type="text/css">';"localhost"!==e&&(t='<link rel="stylesheet" href="css/styles.min.css">');var n=document.getElementById("printOrderTable").innerHTML,o=window.open("","_blank");o.document.open(),o.document.write("<html><head>"+t+'</head><body onload="window.print()">'+n+"</html>"),o.document.close()}var i=this;i.setItemPerPage=e,i.jobGridType=t,i.printOrder=o,n(),i.eventsChosenColumn={onItemDeselect:function(e){1===i.chosenColumnModel.length&&i.chosenColumnModel.push(e)}}}angular.module("main.module").directive("jobGrid",function(){return{restrict:"E",scope:{ngModel:"=",options:"=",gridConfig:"=",actionRequest:"&",isLoading:"=",gridType:"@"},templateUrl:"app/directives/jobCommon/jobGrid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["setItemPerPage","jobGridType"]}(),function(){"use strict";function e(e){function t(e){var t=!1;return angular.forEach(o.chosenColumnModel,function(n){n.id===e&&(t=!0)}),t}function n(t){e.path("/adhoc/detail/"+t)}var o=this;o.isContainColumn=t,o.goToDetailPage=n}angular.module("adhoc.module").directive("adhocJobGrid",function(){return{restrict:"E",scope:{ngModel:"=",chosenColumnModel:"="},templateUrl:"app/directives/adhoc/jobs/adhocJobGrid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$location"]}(),function(){"use strict";function e(){function e(){r.isCheckAll?o():r.listAssignTransaction=[]}function t(e){r.isCheckAll=!1;for(var t=!1,n=0;n<r.listAssignTransaction.length;n++)if(r.listAssignTransaction[n]==e)return t=!0,void r.listAssignTransaction.splice(n,1);r.listAssignTransaction.push(e)}function n(e){for(var t=0;t<r.listAssignTransaction.length;t++)if(r.listAssignTransaction[t]==e)return!0;return!1}function o(){r.listAssignTransaction=[],angular.forEach(r.ngModel,function(e){r.listAssignTransaction.push(e.id)})}function i(e){var t=!1;return angular.forEach(r.chosenColumnModel,function(n){n.id===e&&(t=!0)}),t}var r=this;r.isContainColumn=i,r.listAssignTransaction=[],r.checkAllChange=e,r.bindingCheck=n,r.onCheckTransaction=t}angular.module("adhoc.module").directive("adhocTransactionGrid",function(){return{restrict:"E",scope:{ngModel:"=",chosenColumnModel:"="},templateUrl:"app/directives/adhoc/jobs/adhocTransactionGrid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=[]}();