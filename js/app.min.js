!function(){"use strict";function e(e){e.when("/",{redirectTo:"/customers"}).otherwise({redirectTo:"/"})}function t(e,t,o,n,r){var i=n.getCurrentUser();i?e.currentUser=i:o.path("/login"),e.$on("$locationChangeStart",function(e,r,i){var a=o.path(),s=t.routes[a];if(s&&s.authorize)return n.isAuthenticated()?void(n.isAuthorized(s.authorize)||o.path("/login")):void o.path("/login")}),e.$on("$routeChangeSuccess",function(){t.current&&(e.hideHeader=t.current.hideHeader,e.category=t.current.category),t.current.title?document.title="ST Logistics - "+t.current.title:document.title="ST Logistics"})}function o(e){e.interceptors.push("httpInterceptor")}angular.module("main.module",["ngRoute","ngAnimate","ui.bootstrap","LocalStorageModule","ui.bootstrap.datetimepicker","toastr","customer.module","spAdminUser.module","adminUser.module","account.module"]).config(o).config(e).run(t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","$route","$location","authService","systemRole"],o.$inject=["$httpProvider"]}(),function(){"use strict";angular.module("main.module").constant("systemSetting",{serviceUrl:"http://ec2-52-77-214-252.ap-southeast-1.compute.amazonaws.com"}).constant("systemRole",{Customer:1,Admin:2,SuperAdmin:3}).constant("setItemPerPage",[{value:10,text:"10 entities"},{value:20,text:"20 entities"},{value:50,text:"50 entities"},{value:100,text:"100 entities"}]).constant("pageName",{TRANSACTIONS:"transactions",USERS:"Users",CLIENTS:"Customers",JOBTYPES:"jobtypes",LOCATIONS:"locations",REPORTS:"reports"}).constant("departments",{PSS:{id:1,name:"PSS"},Healthcare:{id:2,name:"Healthcare"}})}(),function(){"use strict";function e(e){e.when("/customers",{title:"Client Management",category:"Customers",controller:"CustomerController",templateUrl:"app/components/customer/customers.html",controllerAs:"vm",authorize:"Admin"}).when("/customers/create",{title:"Create new client",category:"Customers",controller:"CustomerDetailController",templateUrl:"app/components/customer/detail.html",controllerAs:"vm",authorize:"Admin"}).when("/customers/detail/:id",{title:"Client detail",category:"Customers",controller:"CustomerDetailController",templateUrl:"app/components/customer/detail.html",controllerAs:"vm",authorize:"Admin"}).when("/example",{title:"example",controller:"ExampleController",templateUrl:"app/components/customer/example.html",controllerAs:"vm",authorize:"Admin",hideHeader:!0})}function t(e,t){function o(){n()}function n(){a.options={sortColumn:"",sortAscending:!0,itemPerPage:20,currentPage:1,searchTerm:""},a.gridConfig={onClickRowDetail:i,columns:[{name:"sapCode",display:"SAP Code",columnNameSort:"sapCode"},{name:"organizationCode",display:"Organization Code",columnNameSort:"organizationCode"},{name:"organizationName",display:"Organization Name",columnNameSort:"organizationName"},{name:"clientType",display:"ClientType",columnNameSort:"clientType"},{name:"address",display:"Address",columnNameSort:"address"}]},r()}function r(){a.isGridLoading=!0,e(function(){a.data=[];for(var e=0;e<a.options.itemPerPage;e++)a.data.push({id:e,sapCode:"AL05",organizationCode:"ICA",organizationName:"Costal Command",clientType:"Heathcare",address:"31 Minara Costal Drive Singapore 157198571591"});a.options.totalItems=175,a.isGridLoading=!1},1e3)}function i(e){t.path("/customers/detail/"+e.id)}var a=this;a.getCustomerByCriteria=r,o()}function o(e,t,o,n,r){function i(){var e=t.id;if(e){f.clientDetail={id:e,clientName:"Nguyen Minh Tien",clientType:"PSS",sapCode:"AL06",organizationCode:"ICA",clientAddress:{postalCode:"123",bIkNo:"ABC",streetName:"Ansons Road 33",unitNo:"#235-53"},contactPerson:"Jane",contactNumber:98743473443,endDateOfContract:new Date(2018,10,26),users:[],sameDayDelivery:new Date(2018,10,26,10,30),nextDayDelivery:new Date(2018,10,26,20,45),services:{milkRun:{isUsed:!1},adhoc:{isUsed:!0,price:"$100"},adhocExpres:{isUsed:!0,price:"$200"}}};for(var o=0;o<2;o++)f.clientDetail.users.push({name:"May thae Khaing",email:"may.thaekhaing@2359media.com",contactNo:901213213,officeAddress:"Bik 31 Marine Parade Street 29, #10-23 S66",billingAddress:"Bik 31 Marine Parade Street 29, #10-23 S66",orgCode:"ICA",costCentre:"Cost centre 1"});f.viewMode=!0}else f.clientDetail={services:{},users:[]},f.viewMode=!1;f.clientDetail.clientType="PSS"}function a(){o.path("/customers")}function s(){f.clientDetail.clientType===r.PSS.name?l():c()}function l(){var e={setPSSAdhocPricing:d};n.createPopup({templateUrl:"app/components/customer/pssAdhocPricing.html",size:"lg",data:f.pssAdhocPricing},e)}function c(){var e={setHealthCareAdhocPricing:u};n.createPopup({templateUrl:"app/components/customer/healthCareAdhocPricing.html",size:"lg",data:f.pssAdhocPricing},e)}function d(){f.clientDetail.services.adhoc={isUsed:!0,price:"$300"},f.clientDetail.services.adhocExpres={isUsed:!0,price:"$400"}}function u(){f.clientDetail.services.adhoc={isUsed:!0,price:"$500"},f.clientDetail.services.adhocExpres={isUsed:!0,price:"$600"}}function m(){var e={addNewUser:p};n.createPopup({templateUrl:"app/components/customer/userDetail.html",size:"lg",data:f.newUser},e)}function p(){f.clientDetail.users.push({name:f.newUser.firstName+" "+f.newUser.lastName,email:f.newUser.email,contactNo:f.newUser.mobileNumber,officeAddress:f.newUser.workAddress.postalCode+" "+f.newUser.workAddress.bIkNo+" "+f.newUser.workAddress.streetName+" "+f.newUser.workAddress.unitNo,billingAddress:f.newUser.billingAddress.postalCode+" "+f.newUser.billingAddress.bIkNo+" "+f.newUser.billingAddress.streetName+" "+f.newUser.billingAddress.unitNo,orgCode:"ICA",costCentre:f.newUser.costCenter}),f.newUser={}}function g(e){e.isUsed&&!e.price&&(e.isUsed=!1,n.createWarningPopup("Please set pricing for this service first!","Warning",null,!0))}var f=this;f.pssAdhocPricing={},f.healthCareAdhocPricing={},f.newUser={},f.setAdhocPricing=s,f.addNewUser=m,f.saveCustomer=a,f.checkSetPricing=g,i()}function n(e){var t=this;t.open=function(){e.success("Hello world!","Toastr fun!")}}angular.module("customer.module",["ngRoute"]).config(e).controller("CustomerController",t).controller("CustomerDetailController",o).controller("ExampleController",n),e.$inject=["$routeProvider"],t.$inject=["$timeout","$location"],o.$inject=["$rootScope","$routeParams","$location","modalService","departments"],n.$inject=["toastr"]}(),function(){"use strict";function e(e){e.when("/users",{title:"User management",category:"Users",controller:"SpAdminUserController",templateUrl:"app/components/spAdminUser/users.html",controllerAs:"vm",authorize:"SuperAdmin"}).when("/users/create",{title:"New admin",category:"Users",controller:"SpAdminUserDetailController",templateUrl:"app/components/spAdminUser/detail.html",controllerAs:"vm",authorize:"SuperAdmin"}).when("/users/detail/:id",{title:"Admin detail",category:"Users",controller:"SpAdminUserDetailController",templateUrl:"app/components/spAdminUser/detail.html",controllerAs:"vm",authorize:"SuperAdmin"})}function t(e,t){function o(){n(),r()}function n(){a.options={sortColumn:"",sortAscending:!0,itemPerPage:20,currentPage:1,searchTerm:""},a.gridConfig={onClickRowDetail:i,columns:[{name:"name",display:"Name",columnNameSort:"firstName"},{name:"email",display:"Email",columnNameSort:"email"},{name:"phoneNumber",display:"Contact number",columnNameSort:"phoneNumber"},{name:"departmentName",display:"Department",columnNameSort:"department"}]}}function r(){a.isGridLoading=!0,t.getAdminUserByCriteria(a.options).then(function(e){a.options.totalItems=e.data.totalCount;var t=e.data.users;angular.forEach(t,function(e){e.name=e.firstName+" "+e.lastName,e.departmentName=e.department.name}),a.users=t,a.isGridLoading=!1})}function i(t){e.path("/users/detail/"+t.id)}var a=this;a.getAdminUserByCriteria=r,o()}function o(e,t,o,n,r,i){function a(){var t=e.id;t?(o.getAdminUserById(t).then(function(e){u.userDetail=e.data}),u.viewMode=!0):u.viewMode=!1}function s(){u.viewMode=!1}function l(){u.isSaving=!0,o.saveAdminUser(u.userDetail).then(function(e){u.isSaving=!1;var o=u.userDetail.id?"The admin has been updated successfully.":"The admin has been created successfully.";r.success(o),t.path("/users")})}function c(){var e=u.isActive?"Are you sure you want to deactivate this admin?":"Are you sure you want to activate this admin?";i.createWarningPopup(e,"Warning",d)}function d(){var e=u.isActive?"The admin has been deactivated successfully.":"The admin has been activated successfully.";u.isActive=!u.isActive,r.success(e)}var u=this;u.departments=n,u.edit=s,u.save=l,u.deactivate=c,u.isActive=!0,a()}angular.module("spAdminUser.module",["ngRoute"]).config(e).controller("SpAdminUserController",t).controller("SpAdminUserDetailController",o),e.$inject=["$routeProvider"],t.$inject=["$location","adminUserService"],o.$inject=["$routeParams","$location","adminUserService","departments","toastr","modalService"]}(),function(){"use strict";function e(e){e.when("/login",{title:"Login",controller:"AccountController",templateUrl:"app/components/account/login.html",controllerAs:"vm",hideHeader:!0}).when("/account/forgot",{title:"Forgot password",controller:"AccountController",templateUrl:"app/components/account/forgot.html",controllerAs:"vm",hideHeader:!0}).when("/account/activate",{title:"Activate account",controller:"AccountController",templateUrl:"app/components/account/activate.html",controllerAs:"vm",hideHeader:!0})}function t(e,t,o){function n(){return s.email&&s.password?(s.isLoginInProgress=!0,void t.login(s.email,s.password).then(function(e){s.isLoginInProgress=!1,a()},function(){s.password="",s.isLoginInProgress=!1,s.wrongPassword=!0})):void(s.wrongPassword=!0)}function r(){o.path("/login")}function i(){s.isSentResetPassword=!0}function a(){e.currentUser=t.getCurrentUser(),o.path("/customers")}var s=this;s.login=n,s.activateAccount=r,s.resetPassword=i}angular.module("account.module",["ngRoute"]).config(e).controller("AccountController",t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","authService","$location"]}(),function(){"use strict";function e(e){e.when("/clientUsers",{title:"User Client management",category:"Users",controller:"AdminUserController",templateUrl:"app/components/adminUser/clientUsers.html",controllerAs:"vm",authorize:"Admin"})}function t(e,t){function o(){n()}function n(){d.gridConfig={onClickRowDetail:s,columns:[{name:"name",display:"Name",css:"col-md-1"},{name:"email",display:"Email",css:"col-md-2"},{name:"contactNo",display:"Contact no",css:"col-md-2"},{name:"officeAddress",display:"Office address",css:"col-md-2"},{name:"billingAddress",display:"Billing address",css:"col-md-2"},{name:"orgCode",display:"Org code",css:"col-md-1"},{name:"costCentre",display:"Cost centre",css:"col-md-2"}]},r()}function r(){d.isGridLoading=!0,e(function(){d.data=[];for(var e=0;e<10;e++)d.data.push({id:e,name:"Sebastien",email:"nguyeminhtien@gmail.com",contactNo:"96444123",officeAddress:"BIk 31 Martine Parade Street 29, #20-23 S6613426",billingAddress:"BIk 31 Martine Parade Street 29, #20-23 S6613426",orgCode:"ICA",costCentre:"Cost centre "+e});d.options.totalItems=175,d.isGridLoading=!1},1e3)}function i(){d.userDetail={};var e={addNewUser:a};l(e)}function a(){d.data.push({name:d.userDetail.firstName+" "+d.userDetail.lastName,email:d.userDetail.email,contactNo:d.userDetail.mobileNumber,officeAddress:d.userDetail.workAddress.postalCode+" "+d.userDetail.workAddress.bIkNo+" "+d.userDetail.workAddress.streetName+" "+d.userDetail.workAddress.unitNo,billingAddress:d.userDetail.billingAddress.postalCode+" "+d.userDetail.billingAddress.bIkNo+" "+d.userDetail.billingAddress.streetName+" "+d.userDetail.billingAddress.unitNo,orgCode:"ICA",costCentre:d.userDetail.costCenter})}function s(e){d.userDetail={id:2,firstName:"Tien",lastName:"Nguyen Minh",email:"nguyeminhtien@gmail.com",mobileNumber:96444123,workAddress:{postalCode:"Postal Code 1",bIkNo:"BIk 31",streetName:"Martine Parade Street 29",unitNo:"#20-23 S6613426"},billingAddress:{postalCode:"Postal Code 1",bIkNo:"BIk 31",streetName:"Martine Parade Street 29",unitNo:"#20-23 S6613426"},orgCode:"ICA",costCenter:"Cost centre 3"};var t={updateUser:c};l(t)}function l(e){t.createPopup({templateUrl:"app/components/customer/userDetail.html",size:"lg",data:d.userDetail},e)}function c(){alert("messi")}var d=this;d.userDetail={},d.getUserByCriteria=r,d.addNewUser=i,o()}angular.module("adminUser.module",["ngRoute"]).config(e).controller("AdminUserController",t),e.$inject=["$routeProvider"],t.$inject=["$timeout","modalService"]}(),function(){"use strict";function e(e,t,o,n,r){function i(){return!!c()}function a(e){var t=c();return!!(t&&n[t.role]>=n[e])}function s(n,i){var a=t.defer(),s=r.serviceUrl+"/token",l="grant_type=password&username="+n+"&password="+i;return e.post(s,l,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){var t={access_token:e.data.access_token,token_type:e.data.token_type,userName:e.data.userName},n={userName:e.data.userName,role:"superadmin"===e.data.userName?"SuperAdmin":"Admin"};o.set("tokenInfo",t),o.set("userInfo",n),a.resolve()},function(e){a.reject()}),a.promise}function l(){o.remove("tokenInfo"),o.remove("userInfo")}function c(){return o.get("userInfo")}var d={isAuthenticated:i,isAuthorized:a,login:s,logout:l,getCurrentUser:c};return d}angular.module("main.module").factory("authService",e),e.$inject=["$http","$q","localStorageService","systemRole","systemSetting"]}(),function(){"use strict";function e(e){function t(t,o,n){var r=e.open({animation:!0,templateUrl:t.templateUrl,controller:"ModalInstanceCtrl",controllerAs:"vm",size:t.size,backdrop:"static",resolve:{data:function(){return t.data}}});r.result.then(function(e){o[e]()},n)}function o(t,o,n,r){var i=e.open({animation:!0,templateUrl:"app/directives/commonControls/warningModal/warningModal.html",controller:"ModalInstanceCtrl",controllerAs:"vm",backdrop:"static",resolve:{data:function(){return{message:t,title:o,isHideActionButton:r}}}});i.result.then(function(e){n()})}var n={createPopup:t,createWarningPopup:o};return n}angular.module("main.module").factory("modalService",e),e.$inject=["$uibModal"]}(),function(){"use strict";function e(e,t,o){function n(e){e.headers=e.headers||{};var o=t.get("tokenInfo");return o&&(e.headers.Authorization=o.token_type+" "+o.access_token),e}var r={request:n};return r}angular.module("main.module").factory("httpInterceptor",e),e.$inject=["$q","localStorageService","systemSetting"]}(),function(){"use strict";function e(e,t,o){function n(t){return t.id?e.put(a+t.id,t):e.post(a,t)}function r(t){var o=a+"?offset="+(t.currentPage-1)*t.itemPerPage;return o+="&limit="+t.itemPerPage,t.searchTerm&&(o+="&search="+t.searchTerm),t.sortColumn&&(o+="&sortBy="+t.sortColumn,o+="&ascending="+t.sortAscending),e.get(o)}function i(t){return e.get(a+t)}var a=o.serviceUrl+"/api/adminusers/",s={saveAdminUser:n,getAdminUserByCriteria:r,getAdminUserById:i};return s}angular.module("main.module").factory("adminUserService",e),e.$inject=["$http","$q","systemSetting"]}(),function(){"use strict";function e(e){function t(e){o.options.sortColumn===e?o.options.sortAscending=!o.options.sortAscending:(o.options.sortAscending=!0,o.options.sortColumn=e),o.actionRequest()}var o=this;o.setItemPerPage=e,o.options={sortColumn:"",sortAscending:!0,itemPerPage:20},o.sort=t}angular.module("main.module").directive("grid",function(){return{restrict:"E",scope:{gridConfig:"=",options:"=",data:"=",actionRequest:"&",isLoading:"="},templateUrl:"app/directives/commonControls/grid/grid.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["setItemPerPage"]}(),function(){"use strict";function e(e,t){var o=this;o.data=t,o.ok=function(t){e.close(t)},o.cancel=function(){e.dismiss("cancel")}}angular.module("main.module").controller("ModalInstanceCtrl",e),e.$inject=["$uibModalInstance","data"]}(),function(){"use strict";function e(e,t,o,n){function r(){o.logout(),e.currentUser=null,t.path("/login")}var i=this;i.pageName=n,i.logout=r}angular.module("main.module").directive("headerPage",function(){return{restrict:"E",templateUrl:"app/directives/header/header.html",controller:e,controllerAs:"vm",bindToController:!0}}),e.$inject=["$rootScope","$location","authService","pageName"]}(),function(){"use strict";angular.module("main.module").directive("compareTo",function(){return{restrict:"A",require:"ngModel",scope:{compareTo:"=compareTo"},link:function(e,t,o,n){t.bind("keyup",function(){e.$apply(function(){var o=t.val(),r=e.compareTo,i=o&&o===r;n.$setValidity("compareTo",i)})})}}})}(),function(){"use strict";function e(){var e=this;e.isOpen=!1,e.openCalendar=function(t){t.preventDefault(),t.stopPropagation(),e.isOpen=!0}}angular.module("main.module").directive("customDatePicker",function(){return{restrict:"E",scope:{ngModel:"="},templateUrl:"app/directives/commonControls/datePicker/datePicker.html",controller:e,controllerAs:"vm",bindToController:!0}})}(),function(){"use strict";function e(){var e=this;e.timepickerOptions={showMeridian:!1},e.isOpen=!1,e.openCalendar=function(t){t.preventDefault(),t.stopPropagation(),e.isOpen=!0}}angular.module("main.module").directive("customTimePicker",function(){return{restrict:"E",scope:{ngModel:"="},templateUrl:"app/directives/commonControls/timePicker/timePicker.html",controller:e,controllerAs:"vm",bindToController:!0}})}(),function(){"use strict";function e(){function e(e){return[{postalCode:"Postal Code 1",bIkNo:"70",streetName:"Anson Road 1"},{postalCode:"Postal Code 2",bIkNo:"80",streetName:"Anson Road 2"},{postalCode:"Postal Code 3",bIkNo:"70",streetName:"Anson Road 3"}]}function t(e){r.userDetail.workAddress.postalCode=e.postalCode,r.userDetail.workAddress.bIkNo=e.bIkNo,r.userDetail.workAddress.streetName=e.streetName}function o(e){return[{postalCode:"Postal Code 1",bIkNo:"70",streetName:"Anson Road 1"},{postalCode:"Postal Code 2",bIkNo:"80",streetName:"Anson Road 2"},{postalCode:"Postal Code 3",bIkNo:"70",streetName:"Anson Road 3"}]}function n(e){r.userDetail.billingAddress.postalCode=e.postalCode,r.userDetail.billingAddress.bIkNo=e.bIkNo,r.userDetail.billingAddress.streetName=e.streetName}var r=this;r.searchWorkAddressByPostalCode=e,r.onSelectPostalWorkAddress=t,r.searchBillingAddressByPostalCode=o,r.onSelectPostalBillingAddress=n}angular.module("main.module").directive("userClientDetail",function(){return{restrict:"E",scope:{userDetail:"=",onCreate:"&",onCancel:"&"},templateUrl:"app/directives/userClient/userClientDetail.html",controller:e,controllerAs:"vm",bindToController:!0}})}();